<!doctype html>
<html class="no-js" lang="en">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta property="og:title" content="Step 3 - Adding Player Behavior" />
  <meta property="og:type" content="website" />
  <meta property="og:url" content="https://docs.rubato.app/tutorials/platformer/step3.html" />
  <meta property="og:site_name" content="rubato docs" />
  <meta property="og:description" content="In this step, we will be adding player behavior to our character. We want our dinosaur to be able to move left, right and jump. We also want to apply physics laws to him, such as gravity and collisions with future obstacles. First, let's add physics to our dinosaur. To do this, we will add a Rigi..." />
  <meta property="og:image" content="https://raw.githubusercontent.com/rubatopy/rubato/main/docs/source/_static/full.png" />
  <meta property="og:image:alt" content="rubato docs" />
  <meta property="og:title" content="rubato docs"><link rel="search" title="Search" href="../../../search/" /><link rel="next" title="Step 4 - Creating a Level" href="../step4/" /><link rel="prev" title="Step 2 - Creating a Player" href="../step2/" />
        <link rel="canonical" href="https://docs.rubato.app/tutorials/platformer/step3.html" />

    <link rel="shortcut icon" href="https://raw.githubusercontent.com/rubatopy/rubato/main/docs/source/_static/logo_filled.png"/><meta name="generator" content="sphinx-5.1.1, furo 2022.06.21"/>
        <title>Step 3 - Adding Player Behavior - rubato docs</title>
      <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/styles/furo.css?digest=40978830699223671f4072448e654b5958f38b89" />
    <link rel="stylesheet" type="text/css" href="../../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/tabs.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/styles/furo-extensions.css?digest=30d1aed668e5c3a91c3e3bf6a60b675221979f0e" />
    <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.1.1/css/all.min.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/custom.css" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  --color-brand-primary: #ff9484;
  --color-brand-content: #ff9484;
  --color-api-name: #ff9484;
  --font-stack: Fredoka, sans-serif;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  --color-brand-primary: #ff9484;
  --color-brand-content: #ff9484;
  --color-api-name: #ff9484;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  --color-brand-primary: #ff9484;
  --color-brand-content: #ff9484;
  --color-api-name: #ff9484;
  
      }
    }
  }
</style>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-WM5S826BXJ"></script>
<script>
    window.dataLayer = window.dataLayer || [];
    function gtag() {
        dataLayer.push(arguments);
    }
    gtag("js", new Date());

    gtag("config", "G-WM5S826BXJ");
</script>
<script
    src="https://code.jquery.com/jquery-3.6.0.min.js"
    integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4="
    crossorigin="anonymous"
></script>
</head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../../../"><div class="brand">rubato docs</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon no-toc" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><div class="sidebar-scroll"><div id="vtag-name"></div>
<style>
    div#vtag-name {
        color: var(--color-sidebar-caption-text);
        font-size: var(--sidebar-caption-font-size);
        font-weight: 700;
        text-transform: uppercase;
        text-align: right;
        position: relative;
        right: 1.25rem;
        top: 1.75rem;
        margin: -0.25rem 0;
    }
</style>
<script>
    let vtag = document.getElementById("vtag-name");
    function waitForElement() {
        if (typeof window.current !== "undefined") {
            vtag.innerHTML = window.current;
        } else {
            setTimeout(waitForElement, 250);
        }
    }
    waitForElement();
</script>
<a class="sidebar-brand centered" href="https://www.rubato.app">
    
    <div class="sidebar-logo-container">
        <img
            class="sidebar-logo"
            src="https://raw.githubusercontent.com/rubatopy/rubato/main/docs/source/_static/full.png"
            alt="Logo"
            width="240"
            draggable="false"
            style="user-select: none; -moz-user-select: none; -webkit-user-select: none; -webkit-user-drag: none"
        />
    </div>
    
</a><form class="sidebar-search-container" method="get" action="../../../search/" role="search">
  <input class="sidebar-search" placeholder=Search name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-tree">
  <p class="caption" role="heading"><span class="caption-text">Contents</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../intro/">Getting Started</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../api/">Full API Documentation</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../key-names/">Key Names</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../demos/">Demos</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Tutorials</span></p>
<ul class="current">
<li class="toctree-l1 current has-children"><a class="reference internal" href="../">Simple Platformer</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../step1/">Step 1 - Basic Structure</a></li>
<li class="toctree-l2"><a class="reference internal" href="../step2/">Step 2 - Creating a Player</a></li>
<li class="toctree-l2 current current-page"><a class="current reference internal" href="#">Step 3 - Adding Player Behavior</a></li>
<li class="toctree-l2"><a class="reference internal" href="../step4/">Step 4 - Creating a Level</a></li>
<li class="toctree-l2"><a class="reference internal" href="../step5/">Step 5 - Finishing Touches</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../usage_guidelines/">Best Practices / Usage Guidelines</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../pyinstaller/">Bundling to an Application</a></li>
</ul>

</div><div id="versionSidebarInclude"></div>
<script>
    if (window.location.hostname == "localhost") {
        console.log("loading test version sidebar from localhost:8001");
        $("#versionSidebarInclude").load("http://localhost:8001/version_sidebar.html");
    } else {
        $("#versionSidebarInclude").load("https://test.rubato.app/version_sidebar.html");
    }
</script></div>
      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          <div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon no-toc" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main">
          
<div id="topWarning"></div>

<script>
    function genWarning() {
        if (window.current != window.latest && window.current != "latest") {
            div = document.getElementById("topWarning");
            div.classList.add("admonition", "warning");
            let title = document.createElement("p");
            title.classList.add("admonition-title");
            title.innerText = "Warning";

            let content = document.createElement("p");
            if (current == "nightly") {
                content.innerText =
                    "You're reading the documentation for a development version. For the latest released version, ";
            } else {
                content.innerText =
                    "You're reading an old version of this documentation. If you want up-to-date information, ";
            }
            content.innerHTML += `please have a look at <a href='/latest'>${window.latest}</a>.`;

            div.appendChild(title);
            div.appendChild(content);
        }
    }
</script>
<section id="step-3-adding-player-behavior">
<h1>Step 3 - Adding Player Behavior<a class="headerlink" href="#step-3-adding-player-behavior" title="Permalink to this heading">#</a></h1>
<p>In this step, we will be adding player behavior to our character.</p>
<p>We want our dinosaur to be able to move left, right and jump.
We also want to apply physics laws to him, such as gravity and collisions with future obstacles.</p>
<p>First, let's add physics to our dinosaur. To do this, we will add a <a class="reference internal" href="../../../api/#rubato.structure.gameobject.physics.rigidbody.RigidBody" title="rubato.structure.gameobject.physics.rigidbody.RigidBody"><code class="xref py py-func docutils literal notranslate"><span class="pre">RigidBody</span></code></a> component to our
him. Add the following code after the animation code, but before the <code class="docutils literal notranslate"><span class="pre">main.add</span></code> call.</p>
<div class="literal-block-wrapper docutils container" id="id1">
<div class="code-block-caption"><span class="caption-text">shared.py</span><a class="headerlink" href="#id1" title="Permalink to this code">#</a></div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="linenos">18</span><span class="n">player</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">p_animation</span><span class="p">)</span>  <span class="c1"># Add the animation component to the player</span>
<span class="linenos">19</span>
<span class="hll"><span class="linenos">20</span><span class="c1"># define the player rigidbody</span>
</span><span class="hll"><span class="linenos">21</span><span class="n">player_body</span> <span class="o">=</span> <span class="n">rb</span><span class="o">.</span><span class="n">RigidBody</span><span class="p">(</span>
</span><span class="hll"><span class="linenos">22</span>    <span class="n">gravity</span><span class="o">=</span><span class="n">rb</span><span class="o">.</span><span class="n">Vector</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">rb</span><span class="o">.</span><span class="n">Display</span><span class="o">.</span><span class="n">res</span><span class="o">.</span><span class="n">y</span> <span class="o">*</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">),</span>
</span><span class="hll"><span class="linenos">23</span>    <span class="n">pos_correction</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
</span><span class="hll"><span class="linenos">24</span>    <span class="n">friction</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span>
</span><span class="hll"><span class="linenos">25</span><span class="p">)</span>
</span><span class="hll"><span class="linenos">26</span><span class="n">player</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">player_body</span><span class="p">)</span>
</span></pre></div>
</div>
</div>
<dl class="simple">
<dt>This enables physics for our player. Running the file, you should see the dinosaur slowly falling down the screen. 2 things to note here:</dt><dd><ul class="simple">
<li><p>We base the gravity off of our Display resolution so that scaling our screen does not affect the gravity.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">pos_correction</span></code> is the proportion we correct the position of the player every frame if it is colliding with something. Setting it to 1 means that all overlaps are fully corrected in one frame.</p></li>
</ul>
</dd>
</dl>
<p>Let's also add a hitbox to our player. For simplicity, we will use a rectangular hitbox. Add the following code right after the previous block.</p>
<div class="literal-block-wrapper docutils container" id="id2">
<div class="code-block-caption"><span class="caption-text">shared.py</span><a class="headerlink" href="#id2" title="Permalink to this code">#</a></div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="linenos">26</span><span class="n">player</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">player_body</span><span class="p">)</span>
<span class="linenos">27</span>
<span class="hll"><span class="linenos">28</span><span class="c1"># add a hitbox to the player with the collider</span>
</span><span class="hll"><span class="linenos">29</span><span class="n">player</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">rb</span><span class="o">.</span><span class="n">Rectangle</span><span class="p">(</span>
</span><span class="hll"><span class="linenos">30</span>    <span class="n">width</span><span class="o">=</span><span class="mi">64</span><span class="p">,</span>
</span><span class="hll"><span class="linenos">31</span>    <span class="n">height</span><span class="o">=</span><span class="mi">64</span><span class="p">,</span>
</span><span class="hll"><span class="linenos">32</span>    <span class="n">tag</span><span class="o">=</span><span class="s2">&quot;player&quot;</span><span class="p">,</span>
</span><span class="hll"><span class="linenos">33</span><span class="p">))</span>
</span></pre></div>
</div>
</div>
<p>Since we haven't given it a color, this rectangle won't actually draw unless the following debugging line is added to <code class="code docutils literal notranslate"><span class="pre">main.py</span></code>.
Feel free to remove it once you've confirmed that the rectangle was added properly.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">rb</span><span class="o">.</span><span class="n">Game</span><span class="o">.</span><span class="n">debug</span> <span class="o">=</span> <span class="kc">True</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="../../../_images/12.png"><img alt="../../../_images/12.png" class="align-center" src="../../../_images/12.png" style="width: 75%;" /></a>
<p>Running the script at this point should show a falling dinosaur.</p>
<p>Next we need to make a player controller. A player controller is a script that defines how a player reacts to certain stimuli.
In this case, we'll use a player controller to handle keyboard inputs and make our dino move. Make a new file called <code class="code docutils literal notranslate"><span class="pre">player_controller.py</span></code>.</p>
<p>The player controller will be implemented as a custom component. To define a custom component, inherit from rubato's
<a class="reference internal" href="../../../api/#rubato.structure.gameobject.component.Component" title="rubato.structure.gameobject.component.Component"><code class="xref py py-func docutils literal notranslate"><span class="pre">Component</span></code></a> class:</p>
<div class="literal-block-wrapper docutils container" id="id3">
<div class="code-block-caption"><span class="caption-text">player_controller.py</span><a class="headerlink" href="#id3" title="Permalink to this code">#</a></div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="kn">import</span> <span class="nn">rubato</span> <span class="k">as</span> <span class="nn">rb</span>
<span class="linenos"> 2</span>
<span class="linenos"> 3</span><span class="k">class</span> <span class="nc">PlayerController</span><span class="p">(</span><span class="n">rb</span><span class="o">.</span><span class="n">Component</span><span class="p">):</span>
<span class="linenos"> 4</span>
<span class="linenos"> 5</span>    <span class="k">def</span> <span class="nf">setup</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="linenos"> 6</span>        <span class="c1"># Called when added to Game Object.</span>
<span class="linenos"> 7</span>        <span class="c1"># Specifics can be found in the Custom Components tutorial.</span>
<span class="linenos"> 8</span>        <span class="bp">self</span><span class="o">.</span><span class="n">initial_pos</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gameobj</span><span class="o">.</span><span class="n">pos</span><span class="o">.</span><span class="n">clone</span><span class="p">()</span>
<span class="linenos"> 9</span>
<span class="linenos">10</span>        <span class="bp">self</span><span class="o">.</span><span class="n">animation</span><span class="p">:</span> <span class="n">rb</span><span class="o">.</span><span class="n">Animation</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gameobj</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">rb</span><span class="o">.</span><span class="n">Animation</span><span class="p">)</span>
<span class="linenos">11</span>        <span class="bp">self</span><span class="o">.</span><span class="n">rigid</span><span class="p">:</span> <span class="n">rb</span><span class="o">.</span><span class="n">RigidBody</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gameobj</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">rb</span><span class="o">.</span><span class="n">RigidBody</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>Note that we've used the GameObject <code class="code docutils literal notranslate"><span class="pre">get</span></code> method to get references to some of the components.
We'll use those references later when we want to modify the player's state such as its animation.</p>
<p>Let's now add movement. Since we want to check player input every frame, lets create a custom update function.</p>
<div class="literal-block-wrapper docutils container" id="id4">
<div class="code-block-caption"><span class="caption-text">player_controller.py</span><a class="headerlink" href="#id4" title="Permalink to this code">#</a></div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 5</span>    <span class="k">def</span> <span class="nf">setup</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="linenos"> 6</span>        <span class="c1"># Called when added to Game Object.</span>
<span class="linenos"> 7</span>        <span class="c1"># Specifics can be found in the Custom Components tutorial.</span>
<span class="linenos"> 8</span>        <span class="bp">self</span><span class="o">.</span><span class="n">initial_pos</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gameobj</span><span class="o">.</span><span class="n">pos</span><span class="o">.</span><span class="n">clone</span><span class="p">()</span>
<span class="linenos"> 9</span>
<span class="linenos">10</span>        <span class="bp">self</span><span class="o">.</span><span class="n">animation</span><span class="p">:</span> <span class="n">rb</span><span class="o">.</span><span class="n">Animation</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gameobj</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">rb</span><span class="o">.</span><span class="n">Animation</span><span class="p">)</span>
<span class="linenos">11</span>        <span class="bp">self</span><span class="o">.</span><span class="n">rigid</span><span class="p">:</span> <span class="n">rb</span><span class="o">.</span><span class="n">RigidBody</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gameobj</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">rb</span><span class="o">.</span><span class="n">RigidBody</span><span class="p">)</span>
<span class="linenos">12</span>
<span class="hll"><span class="linenos">13</span>    <span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span class="hll"><span class="linenos">14</span>        <span class="c1"># Runs once every frame.</span>
</span><span class="hll"><span class="linenos">15</span>        <span class="c1"># Movement</span>
</span><span class="hll"><span class="linenos">16</span>        <span class="k">if</span> <span class="n">rb</span><span class="o">.</span><span class="n">Input</span><span class="o">.</span><span class="n">key_pressed</span><span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">):</span>
</span><span class="hll"><span class="linenos">17</span>            <span class="bp">self</span><span class="o">.</span><span class="n">rigid</span><span class="o">.</span><span class="n">velocity</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="o">-</span><span class="mi">300</span>
</span><span class="hll"><span class="linenos">18</span>            <span class="bp">self</span><span class="o">.</span><span class="n">animation</span><span class="o">.</span><span class="n">flipx</span> <span class="o">=</span> <span class="kc">True</span>
</span><span class="hll"><span class="linenos">19</span>        <span class="k">elif</span> <span class="n">rb</span><span class="o">.</span><span class="n">Input</span><span class="o">.</span><span class="n">key_pressed</span><span class="p">(</span><span class="s2">&quot;d&quot;</span><span class="p">):</span>
</span><span class="hll"><span class="linenos">20</span>            <span class="bp">self</span><span class="o">.</span><span class="n">rigid</span><span class="o">.</span><span class="n">velocity</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="mi">300</span>
</span><span class="hll"><span class="linenos">21</span>            <span class="bp">self</span><span class="o">.</span><span class="n">animation</span><span class="o">.</span><span class="n">flipx</span> <span class="o">=</span> <span class="kc">False</span>
</span></pre></div>
</div>
</div>
<p>Here we check for player input using <code class="xref py py-func docutils literal notranslate"><span class="pre">key_pressed()</span></code>. We then update the player's horizontal velocity
in the corresponding direction. We also flip the player's animation depending on the direction we want to face.</p>
<p>Next, import the player controller at the top of <code class="code docutils literal notranslate"><span class="pre">shared.py</span></code> and add it to the player.</p>
<div class="literal-block-wrapper docutils container" id="id5">
<div class="code-block-caption"><span class="caption-text">shared.py</span><a class="headerlink" href="#id5" title="Permalink to this code">#</a></div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="linenos">28</span><span class="c1"># add a hitbox to the player with the collider</span>
<span class="linenos">29</span><span class="n">player</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">rb</span><span class="o">.</span><span class="n">Rectangle</span><span class="p">(</span>
<span class="linenos">30</span>    <span class="n">width</span><span class="o">=</span><span class="mi">64</span><span class="p">,</span>
<span class="linenos">31</span>    <span class="n">height</span><span class="o">=</span><span class="mi">64</span><span class="p">,</span>
<span class="linenos">32</span>    <span class="n">tag</span><span class="o">=</span><span class="s2">&quot;player&quot;</span><span class="p">,</span>
<span class="linenos">33</span><span class="p">))</span>
<span class="hll"><span class="linenos">34</span><span class="n">player</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">player_comp</span> <span class="o">:=</span> <span class="n">PlayerController</span><span class="p">())</span>
</span></pre></div>
</div>
</div>
<div class="tip admonition">
<p class="admonition-title">Cool!</p>
<p>The <code class="code docutils literal notranslate"><span class="pre">:=</span></code> operator is called the walrus operator. It assigns the value to the variable on the left and returns the value.
It is equivalent to <code class="code docutils literal notranslate"><span class="pre">player_comp</span> <span class="pre">=</span> <span class="pre">PlayerController()</span></code>, then <code class="code docutils literal notranslate"><span class="pre">player.add(player_comp)</span></code>.</p>
</div>
<p>Finally, let's add a jump behavior. Unlike moving left and right, we don't want the user to be able to move up forever if they keep holding the jump
key. We also want to limit the number of jumps the player gets. We will do this by creating a jump counter and process the jump through an event
listener.</p>
<p>First create a jump count variable in the setup method.</p>
<div class="literal-block-wrapper docutils container" id="id6">
<div class="code-block-caption"><span class="caption-text">player_controller.py</span><a class="headerlink" href="#id6" title="Permalink to this code">#</a></div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 5</span>    <span class="k">def</span> <span class="nf">setup</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="linenos"> 6</span>        <span class="c1"># Called when added to Game Object.</span>
<span class="linenos"> 7</span>        <span class="c1"># Specifics can be found in the Custom Components tutorial.</span>
<span class="linenos"> 8</span>        <span class="bp">self</span><span class="o">.</span><span class="n">initial_pos</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gameobj</span><span class="o">.</span><span class="n">pos</span><span class="o">.</span><span class="n">clone</span><span class="p">()</span>
<span class="linenos"> 9</span>
<span class="linenos">10</span>        <span class="bp">self</span><span class="o">.</span><span class="n">animation</span><span class="p">:</span> <span class="n">rb</span><span class="o">.</span><span class="n">Animation</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gameobj</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">rb</span><span class="o">.</span><span class="n">Animation</span><span class="p">)</span>
<span class="linenos">11</span>        <span class="bp">self</span><span class="o">.</span><span class="n">rigid</span><span class="p">:</span> <span class="n">rb</span><span class="o">.</span><span class="n">RigidBody</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gameobj</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">rb</span><span class="o">.</span><span class="n">RigidBody</span><span class="p">)</span>
<span class="linenos">12</span>
<span class="hll"><span class="linenos">13</span>        <span class="c1"># Tracks the number of jumps the player has left</span>
</span><span class="hll"><span class="linenos">14</span>        <span class="bp">self</span><span class="o">.</span><span class="n">jumps</span> <span class="o">=</span> <span class="mi">2</span>
</span></pre></div>
</div>
</div>
<p>Now onto the event listener.</p>
<p>An event listener is a piece of code that waits for an event to be broadcast and then runs a function. We will create a function to handle jumping
that is called when a key is pressed.</p>
<div class="literal-block-wrapper docutils container" id="id7">
<div class="code-block-caption"><span class="caption-text">player_controller.py</span><a class="headerlink" href="#id7" title="Permalink to this code">#</a></div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="linenos">18</span>    <span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="linenos">19</span>        <span class="c1"># Runs once every frame.</span>
<span class="linenos">20</span>        <span class="c1"># Movement</span>
<span class="linenos">21</span>        <span class="k">if</span> <span class="n">rb</span><span class="o">.</span><span class="n">Input</span><span class="o">.</span><span class="n">key_pressed</span><span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">):</span>
<span class="linenos">22</span>            <span class="bp">self</span><span class="o">.</span><span class="n">rigid</span><span class="o">.</span><span class="n">velocity</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="o">-</span><span class="mi">300</span>
<span class="linenos">23</span>            <span class="bp">self</span><span class="o">.</span><span class="n">animation</span><span class="o">.</span><span class="n">flipx</span> <span class="o">=</span> <span class="kc">True</span>
<span class="linenos">24</span>        <span class="k">elif</span> <span class="n">rb</span><span class="o">.</span><span class="n">Input</span><span class="o">.</span><span class="n">key_pressed</span><span class="p">(</span><span class="s2">&quot;d&quot;</span><span class="p">):</span>
<span class="linenos">25</span>            <span class="bp">self</span><span class="o">.</span><span class="n">rigid</span><span class="o">.</span><span class="n">velocity</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="mi">300</span>
<span class="linenos">26</span>            <span class="bp">self</span><span class="o">.</span><span class="n">animation</span><span class="o">.</span><span class="n">flipx</span> <span class="o">=</span> <span class="kc">False</span>
<span class="linenos">27</span>
<span class="hll"><span class="linenos">28</span>    <span class="k">def</span> <span class="nf">handle_key_down</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">:</span> <span class="n">rb</span><span class="o">.</span><span class="n">KeyResponse</span><span class="p">):</span>
</span><span class="hll"><span class="linenos">29</span>        <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">key</span> <span class="o">==</span> <span class="s2">&quot;w&quot;</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">jumps</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span class="hll"><span class="linenos">30</span>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">jumps</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
</span><span class="hll"><span class="linenos">31</span>                <span class="bp">self</span><span class="o">.</span><span class="n">rigid</span><span class="o">.</span><span class="n">velocity</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="mi">800</span>
</span><span class="hll"><span class="linenos">32</span>                <span class="bp">self</span><span class="o">.</span><span class="n">animation</span><span class="o">.</span><span class="n">set_state</span><span class="p">(</span><span class="s2">&quot;jump&quot;</span><span class="p">,</span> <span class="n">freeze</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</span><span class="hll"><span class="linenos">33</span>            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">jumps</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
</span><span class="hll"><span class="linenos">34</span>                <span class="bp">self</span><span class="o">.</span><span class="n">rigid</span><span class="o">.</span><span class="n">velocity</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="mi">800</span>
</span><span class="hll"><span class="linenos">35</span>                <span class="bp">self</span><span class="o">.</span><span class="n">animation</span><span class="o">.</span><span class="n">set_state</span><span class="p">(</span><span class="s2">&quot;somer&quot;</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
</span><span class="hll"><span class="linenos">36</span>            <span class="bp">self</span><span class="o">.</span><span class="n">jumps</span> <span class="o">-=</span> <span class="mi">1</span>
</span></pre></div>
</div>
</div>
<p>Finally, we register the event handler:</p>
<div class="literal-block-wrapper docutils container" id="id8">
<div class="code-block-caption"><span class="caption-text">player_controller.py</span><a class="headerlink" href="#id8" title="Permalink to this code">#</a></div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 5</span>    <span class="k">def</span> <span class="nf">setup</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="linenos"> 6</span>        <span class="c1"># Called when added to Game Object.</span>
<span class="linenos"> 7</span>        <span class="c1"># Specifics can be found in the Custom Components tutorial.</span>
<span class="linenos"> 8</span>        <span class="bp">self</span><span class="o">.</span><span class="n">initial_pos</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gameobj</span><span class="o">.</span><span class="n">pos</span><span class="o">.</span><span class="n">clone</span><span class="p">()</span>
<span class="linenos"> 9</span>
<span class="linenos">10</span>        <span class="bp">self</span><span class="o">.</span><span class="n">animation</span><span class="p">:</span> <span class="n">rb</span><span class="o">.</span><span class="n">Animation</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gameobj</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">rb</span><span class="o">.</span><span class="n">Animation</span><span class="p">)</span>
<span class="linenos">11</span>        <span class="bp">self</span><span class="o">.</span><span class="n">rigid</span><span class="p">:</span> <span class="n">rb</span><span class="o">.</span><span class="n">RigidBody</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gameobj</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">rb</span><span class="o">.</span><span class="n">RigidBody</span><span class="p">)</span>
<span class="linenos">12</span>
<span class="linenos">13</span>        <span class="c1"># Tracks the number of jumps the player has left</span>
<span class="linenos">14</span>        <span class="bp">self</span><span class="o">.</span><span class="n">jumps</span> <span class="o">=</span> <span class="mi">2</span>
<span class="hll"><span class="linenos">15</span>
</span><span class="hll"><span class="linenos">16</span>        <span class="n">rb</span><span class="o">.</span><span class="n">Radio</span><span class="o">.</span><span class="n">listen</span><span class="p">(</span><span class="n">rb</span><span class="o">.</span><span class="n">Events</span><span class="o">.</span><span class="n">KEYDOWN</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">handle_key_down</span><span class="p">)</span>
</span></pre></div>
</div>
</div>
<p>Let's break this down.</p>
<p>We check if the keydown event's key is &quot;w&quot; and if you still have jumps remaining.
If so, we set the y velocity to 800 (remember that we are in a cartesian system).
We also want to vary the jump animation on your last jump. The first is a regular jump and the second is a somersault.
Finally, we decrement the number of jumps you have left, so you can't jump infinitely.</p>
<p>The <code class="code docutils literal notranslate"><span class="pre">Radio.listen(rb.Events.KEYDOWN,</span> <span class="pre">self.handle_keydown)</span></code> line is where we tell rubato to listen for a keydown event.
Whenever that event is broadcast (this happens automatically), rubato will invoke the <code class="docutils literal notranslate"><span class="pre">handle_keydown</span></code> function.
The <code class="xref py py-func docutils literal notranslate"><span class="pre">Events</span></code> class has many other rubato-triggered events that you can listen for.</p>
<p>Running the script at this point should show a falling dinosaur, and let you jump twice and move a little left and right before falling to your doom.
In the next step, we'll be building the level for the player to explore.</p>
<p>Here is what you should have so far if you've been following along:</p>
<div class="literal-block-wrapper docutils container" id="id9">
<div class="code-block-caption"><span class="caption-text">main.py</span><a class="headerlink" href="#id9" title="Permalink to this code">#</a></div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="kn">import</span> <span class="nn">rubato</span> <span class="k">as</span> <span class="nn">rb</span>
<span class="linenos"> 2</span>
<span class="linenos"> 3</span><span class="c1"># initialize a new game</span>
<span class="linenos"> 4</span><span class="n">rb</span><span class="o">.</span><span class="n">init</span><span class="p">(</span>
<span class="linenos"> 5</span>    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Platformer Demo&quot;</span><span class="p">,</span>  <span class="c1"># Set a name</span>
<span class="linenos"> 6</span>    <span class="n">res</span><span class="o">=</span><span class="p">(</span><span class="mi">1920</span><span class="p">,</span> <span class="mi">1080</span><span class="p">),</span>  <span class="c1"># Set the window resolution (in pixels).</span>
<span class="linenos"> 7</span>    <span class="n">fullscreen</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>  <span class="c1"># Set the window to be fullscreen</span>
<span class="linenos"> 8</span><span class="p">)</span>
<span class="linenos"> 9</span>
<span class="linenos">10</span><span class="kn">import</span> <span class="nn">shared</span>
<span class="linenos">11</span>
<span class="linenos">12</span><span class="n">main</span> <span class="o">=</span> <span class="n">rb</span><span class="o">.</span><span class="n">Scene</span><span class="p">(</span><span class="n">background_color</span><span class="o">=</span><span class="n">rb</span><span class="o">.</span><span class="n">Color</span><span class="o">.</span><span class="n">cyan</span><span class="o">.</span><span class="n">lighter</span><span class="p">())</span>
<span class="linenos">13</span>
<span class="linenos">14</span><span class="c1"># Add the player to the scene</span>
<span class="linenos">15</span><span class="n">main</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">shared</span><span class="o">.</span><span class="n">player</span><span class="p">)</span>
<span class="linenos">16</span>
<span class="linenos">17</span><span class="c1"># begin the game</span>
<span class="linenos">18</span><span class="n">rb</span><span class="o">.</span><span class="n">begin</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="literal-block-wrapper docutils container" id="id10">
<div class="code-block-caption"><span class="caption-text">shared.py</span><a class="headerlink" href="#id10" title="Permalink to this code">#</a></div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="kn">import</span> <span class="nn">rubato</span> <span class="k">as</span> <span class="nn">rb</span>
<span class="hll"><span class="linenos"> 2</span><span class="kn">from</span> <span class="nn">player_controller</span> <span class="kn">import</span> <span class="n">PlayerController</span>
</span><span class="linenos"> 3</span>
<span class="linenos"> 4</span><span class="c1"># Create the player and set its starting position</span>
<span class="linenos"> 5</span><span class="n">player</span> <span class="o">=</span> <span class="n">rb</span><span class="o">.</span><span class="n">GameObject</span><span class="p">(</span>
<span class="linenos"> 6</span>    <span class="n">pos</span><span class="o">=</span><span class="n">rb</span><span class="o">.</span><span class="n">Display</span><span class="o">.</span><span class="n">center_left</span> <span class="o">+</span> <span class="n">rb</span><span class="o">.</span><span class="n">Vector</span><span class="p">(</span><span class="mi">50</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
<span class="linenos"> 7</span>    <span class="n">z_index</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
<span class="linenos"> 8</span><span class="p">)</span>
<span class="linenos"> 9</span>
<span class="linenos">10</span><span class="c1"># Create animation and initialize states</span>
<span class="linenos">11</span><span class="n">p_animation</span> <span class="o">=</span> <span class="n">rb</span><span class="o">.</span><span class="n">Spritesheet</span><span class="o">.</span><span class="n">from_folder</span><span class="p">(</span>
<span class="linenos">12</span>    <span class="n">path</span><span class="o">=</span><span class="s2">&quot;files/dino&quot;</span><span class="p">,</span>
<span class="linenos">13</span>    <span class="n">sprite_size</span><span class="o">=</span><span class="n">rb</span><span class="o">.</span><span class="n">Vector</span><span class="p">(</span><span class="mi">24</span><span class="p">,</span> <span class="mi">24</span><span class="p">),</span>
<span class="linenos">14</span>    <span class="n">default_state</span><span class="o">=</span><span class="s2">&quot;idle&quot;</span><span class="p">,</span>
<span class="linenos">15</span><span class="p">)</span>
<span class="linenos">16</span><span class="n">p_animation</span><span class="o">.</span><span class="n">scale</span> <span class="o">=</span> <span class="n">rb</span><span class="o">.</span><span class="n">Vector</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="linenos">17</span><span class="n">p_animation</span><span class="o">.</span><span class="n">fps</span> <span class="o">=</span> <span class="mi">10</span>  <span class="c1"># The frames will change 10 times a second</span>
<span class="linenos">18</span><span class="n">player</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">p_animation</span><span class="p">)</span>  <span class="c1"># Add the animation component to the player</span>
<span class="linenos">19</span>
<span class="hll"><span class="linenos">20</span><span class="c1"># define the player rigidbody</span>
</span><span class="hll"><span class="linenos">21</span><span class="n">player_body</span> <span class="o">=</span> <span class="n">rb</span><span class="o">.</span><span class="n">RigidBody</span><span class="p">(</span>
</span><span class="hll"><span class="linenos">22</span>    <span class="n">gravity</span><span class="o">=</span><span class="n">rb</span><span class="o">.</span><span class="n">Vector</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">rb</span><span class="o">.</span><span class="n">Display</span><span class="o">.</span><span class="n">res</span><span class="o">.</span><span class="n">y</span> <span class="o">*</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">),</span>
</span><span class="hll"><span class="linenos">23</span>    <span class="n">pos_correction</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
</span><span class="hll"><span class="linenos">24</span>    <span class="n">friction</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span>
</span><span class="hll"><span class="linenos">25</span><span class="p">)</span>
</span><span class="hll"><span class="linenos">26</span><span class="n">player</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">player_body</span><span class="p">)</span>
</span><span class="hll"><span class="linenos">27</span>
</span><span class="hll"><span class="linenos">28</span><span class="c1"># add a hitbox to the player with the collider</span>
</span><span class="hll"><span class="linenos">29</span><span class="n">player</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">rb</span><span class="o">.</span><span class="n">Rectangle</span><span class="p">(</span>
</span><span class="hll"><span class="linenos">30</span>    <span class="n">width</span><span class="o">=</span><span class="mi">64</span><span class="p">,</span>
</span><span class="hll"><span class="linenos">31</span>    <span class="n">height</span><span class="o">=</span><span class="mi">64</span><span class="p">,</span>
</span><span class="hll"><span class="linenos">32</span>    <span class="n">tag</span><span class="o">=</span><span class="s2">&quot;player&quot;</span><span class="p">,</span>
</span><span class="hll"><span class="linenos">33</span><span class="p">))</span>
</span><span class="hll"><span class="linenos">34</span><span class="n">player</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">player_comp</span> <span class="o">:=</span> <span class="n">PlayerController</span><span class="p">())</span>
</span></pre></div>
</div>
</div>
<div class="literal-block-wrapper docutils container" id="id11">
<div class="code-block-caption"><span class="caption-text">player_controller.py</span><a class="headerlink" href="#id11" title="Permalink to this code">#</a></div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="hll"><span class="linenos"> 1</span><span class="kn">import</span> <span class="nn">rubato</span> <span class="k">as</span> <span class="nn">rb</span>
</span><span class="hll"><span class="linenos"> 2</span>
</span><span class="hll"><span class="linenos"> 3</span><span class="k">class</span> <span class="nc">PlayerController</span><span class="p">(</span><span class="n">rb</span><span class="o">.</span><span class="n">Component</span><span class="p">):</span>
</span><span class="hll"><span class="linenos"> 4</span>
</span><span class="hll"><span class="linenos"> 5</span>    <span class="k">def</span> <span class="nf">setup</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span class="hll"><span class="linenos"> 6</span>        <span class="c1"># Called when added to Game Object.</span>
</span><span class="hll"><span class="linenos"> 7</span>        <span class="c1"># Specifics can be found in the Custom Components tutorial.</span>
</span><span class="hll"><span class="linenos"> 8</span>        <span class="bp">self</span><span class="o">.</span><span class="n">initial_pos</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gameobj</span><span class="o">.</span><span class="n">pos</span><span class="o">.</span><span class="n">clone</span><span class="p">()</span>
</span><span class="hll"><span class="linenos"> 9</span>
</span><span class="hll"><span class="linenos">10</span>        <span class="bp">self</span><span class="o">.</span><span class="n">animation</span><span class="p">:</span> <span class="n">rb</span><span class="o">.</span><span class="n">Animation</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gameobj</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">rb</span><span class="o">.</span><span class="n">Animation</span><span class="p">)</span>
</span><span class="hll"><span class="linenos">11</span>        <span class="bp">self</span><span class="o">.</span><span class="n">rigid</span><span class="p">:</span> <span class="n">rb</span><span class="o">.</span><span class="n">RigidBody</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gameobj</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">rb</span><span class="o">.</span><span class="n">RigidBody</span><span class="p">)</span>
</span><span class="hll"><span class="linenos">12</span>
</span><span class="hll"><span class="linenos">13</span>        <span class="c1"># Tracks the number of jumps the player has left</span>
</span><span class="hll"><span class="linenos">14</span>        <span class="bp">self</span><span class="o">.</span><span class="n">jumps</span> <span class="o">=</span> <span class="mi">2</span>
</span><span class="hll"><span class="linenos">15</span>
</span><span class="hll"><span class="linenos">16</span>        <span class="n">rb</span><span class="o">.</span><span class="n">Radio</span><span class="o">.</span><span class="n">listen</span><span class="p">(</span><span class="n">rb</span><span class="o">.</span><span class="n">Events</span><span class="o">.</span><span class="n">KEYDOWN</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">handle_key_down</span><span class="p">)</span>
</span><span class="hll"><span class="linenos">17</span>
</span><span class="hll"><span class="linenos">18</span>    <span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span class="hll"><span class="linenos">19</span>        <span class="c1"># Runs once every frame.</span>
</span><span class="hll"><span class="linenos">20</span>        <span class="c1"># Movement</span>
</span><span class="hll"><span class="linenos">21</span>        <span class="k">if</span> <span class="n">rb</span><span class="o">.</span><span class="n">Input</span><span class="o">.</span><span class="n">key_pressed</span><span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">):</span>
</span><span class="hll"><span class="linenos">22</span>            <span class="bp">self</span><span class="o">.</span><span class="n">rigid</span><span class="o">.</span><span class="n">velocity</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="o">-</span><span class="mi">300</span>
</span><span class="hll"><span class="linenos">23</span>            <span class="bp">self</span><span class="o">.</span><span class="n">animation</span><span class="o">.</span><span class="n">flipx</span> <span class="o">=</span> <span class="kc">True</span>
</span><span class="hll"><span class="linenos">24</span>        <span class="k">elif</span> <span class="n">rb</span><span class="o">.</span><span class="n">Input</span><span class="o">.</span><span class="n">key_pressed</span><span class="p">(</span><span class="s2">&quot;d&quot;</span><span class="p">):</span>
</span><span class="hll"><span class="linenos">25</span>            <span class="bp">self</span><span class="o">.</span><span class="n">rigid</span><span class="o">.</span><span class="n">velocity</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="mi">300</span>
</span><span class="hll"><span class="linenos">26</span>            <span class="bp">self</span><span class="o">.</span><span class="n">animation</span><span class="o">.</span><span class="n">flipx</span> <span class="o">=</span> <span class="kc">False</span>
</span><span class="hll"><span class="linenos">27</span>
</span><span class="hll"><span class="linenos">28</span>    <span class="k">def</span> <span class="nf">handle_key_down</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">:</span> <span class="n">rb</span><span class="o">.</span><span class="n">KeyResponse</span><span class="p">):</span>
</span><span class="hll"><span class="linenos">29</span>        <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">key</span> <span class="o">==</span> <span class="s2">&quot;w&quot;</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">jumps</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span class="hll"><span class="linenos">30</span>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">jumps</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
</span><span class="hll"><span class="linenos">31</span>                <span class="bp">self</span><span class="o">.</span><span class="n">rigid</span><span class="o">.</span><span class="n">velocity</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="mi">800</span>
</span><span class="hll"><span class="linenos">32</span>                <span class="bp">self</span><span class="o">.</span><span class="n">animation</span><span class="o">.</span><span class="n">set_state</span><span class="p">(</span><span class="s2">&quot;jump&quot;</span><span class="p">,</span> <span class="n">freeze</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</span><span class="hll"><span class="linenos">33</span>            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">jumps</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
</span><span class="hll"><span class="linenos">34</span>                <span class="bp">self</span><span class="o">.</span><span class="n">rigid</span><span class="o">.</span><span class="n">velocity</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="mi">800</span>
</span><span class="hll"><span class="linenos">35</span>                <span class="bp">self</span><span class="o">.</span><span class="n">animation</span><span class="o">.</span><span class="n">set_state</span><span class="p">(</span><span class="s2">&quot;somer&quot;</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
</span><span class="hll"><span class="linenos">36</span>            <span class="bp">self</span><span class="o">.</span><span class="n">jumps</span> <span class="o">-=</span> <span class="mi">1</span>
</span></pre></div>
</div>
</div>
</section>
 
        </article>
      </div>
      <footer>
        
<div class="related-pages">
    <a class="next-page" href="../step4/">
        <div class="page-info">
            <div class="context">
                <span>Next</span>
            </div>
            <div class="title">Step 4 - Creating a Level</div>
        </div>
        <svg><use href="#svg-arrow-right"></use></svg>
    </a> <a class="prev-page" href="../step2/">
        <svg><use href="#svg-arrow-right"></use></svg>
        <div class="page-info">
            <div class="context">
                <span>Previous</span>
            </div>
            
            <div class="title">Step 2 - Creating a Player</div>
            
        </div>
    </a>
</div>
<div class="bottom-of-page">
    <div class="left-details">
        <div class="copyright"> Copyright &#169; 2022, Martin Chaperot, Tomer Sedan, Yamm Elnekave
        </div>
    </div>
    <div class="right-details">
        <div class="icons"><a class="muted-link" href="https://github.com/rubatopy/rubato" aria-label="On GitHub">
                <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 16 16">
                    <path
                        fill-rule="evenodd"
                        d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0 0 16 8c0-4.42-3.58-8-8-8z"
                    ></path>
                </svg>
            </a>
        </div>
    </div>
</div>

      </footer>
    </div>
    <aside class="toc-drawer no-toc">
      
      
      
    </aside>
  </div>
</div><script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
    <script src="../../../_static/jquery.js"></script>
    <script src="../../../_static/underscore.js"></script>
    <script src="../../../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../../../_static/doctools.js"></script>
    <script src="../../../_static/scripts/furo.js"></script>
    <script src="../../../_static/clipboard.min.js"></script>
    <script src="../../../_static/copybutton.js"></script>
    <script src="../../../_static/tabs.js"></script>
    <script src="../../../_static/design-tabs.js"></script>
    </body>
</html>