<!doctype html>
<html class="no-js" lang="en">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta property="og:title" content="Step 5 - Finishing Touches" />
  <meta property="og:type" content="website" />
  <meta property="og:url" content="https://docs.rubato.app/tutorials/platformer/step5.html" />
  <meta property="og:site_name" content="rubato docs" />
  <meta property="og:description" content="This is the final step! We'll be making small quality-of-life changes to the game to make it play more like a real platformer. Jump Limit: Right now, when you move around, you'll find that you quickly run out of jumps. This is because we implemented a 2 jump limit. However, once you run out of ju..." />
  <meta property="og:image" content="https://raw.githubusercontent.com/rubatopy/rubato/main/docs/source/_static/full.png" />
  <meta property="og:image:alt" content="rubato docs" />
  <meta property="og:title" content="rubato docs"><link rel="search" title="Search" href="../../../search/" /><link rel="next" title="Custom Components" href="../../advanced/custom_components/" /><link rel="prev" title="Step 4 - Creating a Level" href="../step4/" />
        <link rel="canonical" href="https://docs.rubato.app/tutorials/platformer/step5.html" />

    <link rel="shortcut icon" href="https://raw.githubusercontent.com/rubatopy/rubato/main/docs/source/_static/logo_filled.png"/><meta name="generator" content="sphinx-5.1.1, furo 2022.06.21"/>
        <title>Step 5 - Finishing Touches - rubato docs</title>
      <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/styles/furo.css?digest=40978830699223671f4072448e654b5958f38b89" />
    <link rel="stylesheet" type="text/css" href="../../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/tabs.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/styles/furo-extensions.css?digest=30d1aed668e5c3a91c3e3bf6a60b675221979f0e" />
    <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.1.1/css/all.min.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/custom.css" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  --color-brand-primary: #ff9484;
  --color-brand-content: #ff9484;
  --color-api-name: #ff9484;
  --font-stack: Fredoka, sans-serif;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  --color-brand-primary: #ff9484;
  --color-brand-content: #ff9484;
  --color-api-name: #ff9484;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  --color-brand-primary: #ff9484;
  --color-brand-content: #ff9484;
  --color-api-name: #ff9484;
  
      }
    }
  }
</style>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-WM5S826BXJ"></script>
<script>
    window.dataLayer = window.dataLayer || [];
    function gtag() {
        dataLayer.push(arguments);
    }
    gtag("js", new Date());

    gtag("config", "G-WM5S826BXJ");
</script>
<script
    src="https://code.jquery.com/jquery-3.6.0.min.js"
    integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4="
    crossorigin="anonymous"
></script>
</head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../../../"><div class="brand">rubato docs</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><div class="sidebar-scroll"><div id="vtag-name"></div>
<style>
    div#vtag-name {
        color: var(--color-sidebar-caption-text);
        font-size: var(--sidebar-caption-font-size);
        font-weight: 700;
        text-transform: uppercase;
        text-align: right;
        position: relative;
        right: 1.25rem;
        top: 1.75rem;
        margin: -0.25rem 0;
    }
</style>
<script>
    let vtag = document.getElementById("vtag-name");
    function waitForElement() {
        if (typeof window.current !== "undefined") {
            vtag.innerHTML = window.current;
        } else {
            setTimeout(waitForElement, 250);
        }
    }
    waitForElement();
</script>
<a class="sidebar-brand centered" href="https://www.rubato.app">
    
    <div class="sidebar-logo-container">
        <img
            class="sidebar-logo"
            src="https://raw.githubusercontent.com/rubatopy/rubato/main/docs/source/_static/full.png"
            alt="Logo"
            width="240"
            draggable="false"
            style="user-select: none; -moz-user-select: none; -webkit-user-select: none; -webkit-user-drag: none"
        />
    </div>
    
</a><form class="sidebar-search-container" method="get" action="../../../search/" role="search">
  <input class="sidebar-search" placeholder=Search name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-tree">
  <p class="caption" role="heading"><span class="caption-text">Contents</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../intro/">Getting Started</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../api/">Full API Documentation</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../events/">Event Details</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../key-names/">Key Names</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Tutorials</span></p>
<ul class="current">
<li class="toctree-l1 current has-children"><a class="reference internal" href="../">Simple Platformer</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../step1/">Step 1 - Basic Structure</a></li>
<li class="toctree-l2"><a class="reference internal" href="../step2/">Step 2 - Creating a Player</a></li>
<li class="toctree-l2"><a class="reference internal" href="../step3/">Step 3 - Adding Player Behavior</a></li>
<li class="toctree-l2"><a class="reference internal" href="../step4/">Step 4 - Creating a Level</a></li>
<li class="toctree-l2 current current-page"><a class="current reference internal" href="#">Step 5 - Finishing Touches</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../advanced/custom_components/">Custom Components</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../advanced/pyinstaller/">Bundling to an Application</a></li>
</ul>

</div><div id="versionSidebarInclude"></div>
<script>
    if (window.location.hostname == "localhost") {
        console.log("loading test version sidebar from localhost:8001");
        $("#versionSidebarInclude").load("http://localhost:8001/version_sidebar.html");
    } else {
        $("#versionSidebarInclude").load("https://test.rubato.app/version_sidebar.html");
    }
</script></div>
      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          <div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main">
          
<div id="topWarning"></div>

<script>
    function genWarning() {
        if (window.current != window.latest && window.current != "latest") {
            div = document.getElementById("topWarning");
            div.classList.add("admonition", "warning");
            let title = document.createElement("p");
            title.classList.add("admonition-title");
            title.innerText = "Warning";

            let content = document.createElement("p");
            if (current == "nightly") {
                content.innerText =
                    "You're reading the documentation for a development version. For the latest released version, ";
            } else {
                content.innerText =
                    "You're reading an old version of this documentation. If you want up-to-date information, ";
            }
            content.innerHTML += `please have a look at <a href='/latest'>${window.latest}</a>.`;

            div.appendChild(title);
            div.appendChild(content);
        }
    }
</script>
<section id="step-5-finishing-touches">
<h1>Step 5 - Finishing Touches<a class="headerlink" href="#step-5-finishing-touches" title="Permalink to this heading">#</a></h1>
<p>This is the final step! We'll be making small quality-of-life changes to the game to make it play more like a real platformer.</p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>This step covers general game development concepts that are not unique to rubato (grounding detection, camera scrolling, etc). We will not be going
over how these work, rather we will be focusing on how to implement them in our game. A quick Google search on any of these topics is a great place
to start learning.</p>
</div>
<section id="jump-limit">
<h2>Jump Limit<a class="headerlink" href="#jump-limit" title="Permalink to this heading">#</a></h2>
<p>Right now, when you move around, you'll find that you quickly run out of jumps. This is because we implemented a 2 jump limit. However,
once you run out of jumps, you can't do anything to reset your jump counter. We want this counter to be reset whenever you land on the ground. To do
this, we will add a ground detection hitbox to the player, making sure to set the <code class="docutils literal notranslate"><span class="pre">trigger</span></code> parameter to true.</p>
<p>Making a hitbox a &quot;trigger&quot; prevents the hitbox from colliding. It will still detect collisions and call the relevant callbacks.
We will define a player_collide callback that will be called when the player's ground detector collides.
When this happens, we use the provided collision <a class="reference internal" href="../../../api/#rubato.struct.gameobject.physics.engine.Manifold" title="rubato.struct.gameobject.physics.engine.Manifold"><code class="xref py py-func docutils literal notranslate"><span class="pre">Manifold</span></code></a> to
make sure the other collider is a ground hitbox, that we are not already grounded, and that we are indeed falling towards the ground.
That code looks like this:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">grounded</span> <span class="o">=</span> <span class="kc">False</span> <span class="c1"># This line should be under the jump counter variable</span>

<span class="k">def</span> <span class="nf">player_collide</span><span class="p">(</span><span class="n">col_info</span><span class="p">:</span> <span class="n">rb</span><span class="o">.</span><span class="n">Manifold</span><span class="p">):</span>
    <span class="k">global</span> <span class="n">jumps</span><span class="p">,</span> <span class="n">grounded</span>
    <span class="k">if</span> <span class="n">col_info</span><span class="o">.</span><span class="n">shape_b</span><span class="o">.</span><span class="n">tag</span> <span class="o">==</span> <span class="s2">&quot;ground&quot;</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">grounded</span> <span class="ow">and</span> <span class="n">player_body</span><span class="o">.</span><span class="n">velocity</span><span class="o">.</span><span class="n">y</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">grounded</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="n">jumps</span> <span class="o">=</span> <span class="mi">2</span>
        <span class="n">p_animation</span><span class="o">.</span><span class="n">set_state</span><span class="p">(</span><span class="s2">&quot;idle&quot;</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>

<span class="c1"># add a hitbox to the player with the collider</span>
<span class="n">player</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">rb</span><span class="o">.</span><span class="n">Rectangle</span><span class="p">(</span><span class="n">width</span><span class="o">=</span><span class="mi">64</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">64</span><span class="p">,</span> <span class="n">tag</span><span class="o">=</span><span class="s2">&quot;player&quot;</span><span class="p">))</span> <span class="c1"># This line should already be in your code</span>
<span class="c1"># add a ground detector</span>
<span class="n">player</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">rb</span><span class="o">.</span><span class="n">Rectangle</span><span class="p">(</span>
    <span class="n">width</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
    <span class="n">height</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
    <span class="n">offset</span><span class="o">=</span><span class="n">rb</span><span class="o">.</span><span class="n">Vector</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">32</span><span class="p">),</span>
    <span class="n">trigger</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">on_collide</span><span class="o">=</span><span class="n">player_collide</span><span class="p">,</span>
<span class="p">))</span>
</pre></div>
</div>
<p>For this to work, you also need to update the event listner at the bottom to look like this:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># define a custom input listener</span>
<span class="k">def</span> <span class="nf">handle_keydown</span><span class="p">(</span><span class="n">event</span><span class="p">):</span>
    <span class="k">global</span> <span class="n">jumps</span><span class="p">,</span> <span class="n">grounded</span>
    <span class="k">if</span> <span class="n">event</span><span class="p">[</span><span class="s2">&quot;key&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;w&quot;</span> <span class="ow">and</span> <span class="n">jumps</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">grounded</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="n">player_body</span><span class="o">.</span><span class="n">velocity</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="o">-</span><span class="mi">800</span>
        <span class="k">if</span> <span class="n">jumps</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
            <span class="n">p_animation</span><span class="o">.</span><span class="n">set_state</span><span class="p">(</span><span class="s2">&quot;jump&quot;</span><span class="p">,</span> <span class="n">freeze</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">jumps</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">p_animation</span><span class="o">.</span><span class="n">set_state</span><span class="p">(</span><span class="s2">&quot;somer&quot;</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
        <span class="n">jumps</span> <span class="o">-=</span> <span class="mi">1</span>
</pre></div>
</div>
</section>
<section id="camera-scroll">
<h2>Camera Scroll<a class="headerlink" href="#camera-scroll" title="Permalink to this heading">#</a></h2>
<p>In your testing, you may have also noticed that you are able to walk past the right side of your screen. This is because there is actually more level
space there! Remember that we set our level to be 120% the width of the screen. Lets use rubato's built-in lerp function to make our camera follow the player.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># define a custom fixed update function</span>
<span class="k">def</span> <span class="nf">fixed_update</span><span class="p">():</span>
    <span class="c1"># have the camera follow the player</span>
    <span class="n">camera_ideal</span> <span class="o">=</span> <span class="n">rb</span><span class="o">.</span><span class="n">Math</span><span class="o">.</span><span class="n">clamp</span><span class="p">(</span>
        <span class="n">player</span><span class="o">.</span><span class="n">pos</span><span class="o">.</span><span class="n">x</span> <span class="o">+</span> <span class="n">rb</span><span class="o">.</span><span class="n">Display</span><span class="o">.</span><span class="n">res</span><span class="o">.</span><span class="n">x</span> <span class="o">/</span> <span class="mi">4</span><span class="p">,</span> <span class="n">rb</span><span class="o">.</span><span class="n">Display</span><span class="o">.</span><span class="n">center</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">level_size</span> <span class="o">-</span> <span class="n">rb</span><span class="o">.</span><span class="n">Display</span><span class="o">.</span><span class="n">res</span><span class="o">.</span><span class="n">x</span> <span class="o">/</span> <span class="mi">2</span>
    <span class="p">)</span>
    <span class="n">rb</span><span class="o">.</span><span class="n">Game</span><span class="o">.</span><span class="n">camera</span><span class="o">.</span><span class="n">pos</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">rb</span><span class="o">.</span><span class="n">Math</span><span class="o">.</span><span class="n">lerp</span><span class="p">(</span><span class="n">rb</span><span class="o">.</span><span class="n">Game</span><span class="o">.</span><span class="n">camera</span><span class="o">.</span><span class="n">pos</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">camera_ideal</span><span class="p">,</span> <span class="n">rb</span><span class="o">.</span><span class="n">Time</span><span class="o">.</span><span class="n">fixed_delta</span> <span class="o">/</span> <span class="mf">0.4</span><span class="p">)</span>


<span class="c1"># set the scene&#39;s update function</span>
<span class="n">main</span><span class="o">.</span><span class="n">update</span> <span class="o">=</span> <span class="n">update</span> <span class="c1"># This line should already exist in your code</span>
<span class="n">main</span><span class="o">.</span><span class="n">fixed_update</span> <span class="o">=</span> <span class="n">fixed_update</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">lerp</span></code> and <code class="docutils literal notranslate"><span class="pre">clamp</span></code> are both built-in methods to the <a class="reference internal" href="../../../api/#rubato.utils.rb_math.Math" title="rubato.utils.rb_math.Math"><code class="xref py py-func docutils literal notranslate"><span class="pre">rb.Math</span></code></a> class.
Note that we've used <a class="reference internal" href="../../../api/#rubato.utils.rb_time.Time.fixed_delta" title="rubato.utils.rb_time.Time.fixed_delta"><code class="xref py py-func docutils literal notranslate"><span class="pre">rb.Time.fixed_delta</span></code></a>, which represents the
time elapsed since the last update to the physics engine, in seconds. This is to make our camera follow the player more smoothly,
in line with the fps.</p>
</section>
<section id="to-conclude">
<h2>To Conclude<a class="headerlink" href="#to-conclude" title="Permalink to this heading">#</a></h2>
<p><strong>That's it! You've finished your first platformer in rubato!</strong></p>
<p>This was just the tip of the iceberg of what rubato can do.</p>
<details class="sd-sphinx-override sd-dropdown sd-card sd-mb-3">
<summary class="sd-summary-title sd-card-header">
If you got lost, here's the full code, just for kicks:<div class="sd-summary-down docutils">
<svg version="1.1" width="1.5em" height="1.5em" class="sd-octicon sd-octicon-chevron-down" viewBox="0 0 24 24" aria-hidden="true"><path fill-rule="evenodd" d="M5.22 8.72a.75.75 0 000 1.06l6.25 6.25a.75.75 0 001.06 0l6.25-6.25a.75.75 0 00-1.06-1.06L12 14.44 6.28 8.72a.75.75 0 00-1.06 0z"></path></svg></div>
<div class="sd-summary-up docutils">
<svg version="1.1" width="1.5em" height="1.5em" class="sd-octicon sd-octicon-chevron-up" viewBox="0 0 24 24" aria-hidden="true"><path fill-rule="evenodd" d="M18.78 15.28a.75.75 0 000-1.06l-6.25-6.25a.75.75 0 00-1.06 0l-6.25 6.25a.75.75 0 101.06 1.06L12 9.56l5.72 5.72a.75.75 0 001.06 0z"></path></svg></div>
</summary><div class="sd-summary-content sd-card-body docutils">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">rubato</span> <span class="k">as</span> <span class="nn">rb</span>

<span class="c1"># initialize a new game</span>
<span class="n">rb</span><span class="o">.</span><span class="n">init</span><span class="p">(</span>
    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Platformer Demo&quot;</span><span class="p">,</span>  <span class="c1"># Set a name</span>
    <span class="n">res</span><span class="o">=</span><span class="n">rb</span><span class="o">.</span><span class="n">Vector</span><span class="p">(</span><span class="mi">1920</span><span class="p">,</span> <span class="mi">1080</span><span class="p">),</span>  <span class="c1"># Set the window resolution (pixel length and height).</span>
        <span class="c1"># note that since we didn&#39;t also specify a window size,</span>
        <span class="c1"># the window will be automatically resized to half of the resolution.</span>
<span class="p">)</span>

<span class="n">rb</span><span class="o">.</span><span class="n">Game</span><span class="o">.</span><span class="n">debug</span> <span class="o">=</span> <span class="kc">True</span>

<span class="n">grounded</span> <span class="o">=</span> <span class="kc">False</span>
<span class="c1"># Tracks the number of jumps the player has left</span>
<span class="n">jumps</span> <span class="o">=</span> <span class="mi">2</span>
<span class="c1"># size of level</span>
<span class="n">level_size</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">rb</span><span class="o">.</span><span class="n">Display</span><span class="o">.</span><span class="n">res</span><span class="o">.</span><span class="n">x</span> <span class="o">*</span> <span class="mf">1.2</span><span class="p">)</span>

<span class="c1"># Create a scene</span>
<span class="n">main</span> <span class="o">=</span> <span class="n">rb</span><span class="o">.</span><span class="n">Scene</span><span class="p">(</span><span class="n">background_color</span><span class="o">=</span><span class="n">rb</span><span class="o">.</span><span class="n">Color</span><span class="o">.</span><span class="n">cyan</span><span class="o">.</span><span class="n">lighter</span><span class="p">())</span>

<span class="c1"># Create the player and set its starting position</span>
<span class="n">player</span> <span class="o">=</span> <span class="n">rb</span><span class="o">.</span><span class="n">GameObject</span><span class="p">(</span>
    <span class="n">pos</span><span class="o">=</span><span class="n">rb</span><span class="o">.</span><span class="n">Display</span><span class="o">.</span><span class="n">center_left</span> <span class="o">+</span> <span class="n">rb</span><span class="o">.</span><span class="n">Vector</span><span class="p">(</span><span class="mi">50</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
    <span class="n">z_index</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
<span class="p">)</span>

<span class="c1"># Create animation and initialize states</span>
<span class="n">p_animation</span> <span class="o">=</span> <span class="n">rb</span><span class="o">.</span><span class="n">Spritesheet</span><span class="o">.</span><span class="n">from_folder</span><span class="p">(</span>
    <span class="n">path</span><span class="o">=</span><span class="s2">&quot;files/dino&quot;</span><span class="p">,</span>
    <span class="n">sprite_size</span><span class="o">=</span><span class="n">rb</span><span class="o">.</span><span class="n">Vector</span><span class="p">(</span><span class="mi">24</span><span class="p">,</span> <span class="mi">24</span><span class="p">),</span>
    <span class="n">default_state</span><span class="o">=</span><span class="s2">&quot;idle&quot;</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">p_animation</span><span class="o">.</span><span class="n">scale</span> <span class="o">=</span> <span class="n">rb</span><span class="o">.</span><span class="n">Vector</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="n">p_animation</span><span class="o">.</span><span class="n">fps</span> <span class="o">=</span> <span class="mi">10</span>  <span class="c1"># The frames will change 10 times a second</span>
<span class="n">player</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">p_animation</span><span class="p">)</span>  <span class="c1"># Add the animation component to the player</span>

<span class="c1"># define the player rigidbody</span>
<span class="n">player_body</span> <span class="o">=</span> <span class="n">rb</span><span class="o">.</span><span class="n">RigidBody</span><span class="p">(</span>
    <span class="n">gravity</span><span class="o">=</span><span class="n">rb</span><span class="o">.</span><span class="n">Vector</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">rb</span><span class="o">.</span><span class="n">Display</span><span class="o">.</span><span class="n">res</span><span class="o">.</span><span class="n">y</span> <span class="o">*</span> <span class="mf">1.5</span><span class="p">),</span>
    <span class="n">pos_correction</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">friction</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">player</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">player_body</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">player_collide</span><span class="p">(</span><span class="n">col_info</span><span class="p">:</span> <span class="n">rb</span><span class="o">.</span><span class="n">Manifold</span><span class="p">):</span>
    <span class="k">global</span> <span class="n">jumps</span><span class="p">,</span> <span class="n">grounded</span>
    <span class="k">if</span> <span class="n">col_info</span><span class="o">.</span><span class="n">shape_b</span><span class="o">.</span><span class="n">tag</span> <span class="o">==</span> <span class="s2">&quot;ground&quot;</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">grounded</span> <span class="ow">and</span> <span class="n">player_body</span><span class="o">.</span><span class="n">velocity</span><span class="o">.</span><span class="n">y</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">grounded</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="n">jumps</span> <span class="o">=</span> <span class="mi">2</span>
        <span class="n">p_animation</span><span class="o">.</span><span class="n">set_state</span><span class="p">(</span><span class="s2">&quot;idle&quot;</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>


<span class="c1"># add a hitbox to the player with the collider</span>
<span class="n">player</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">rb</span><span class="o">.</span><span class="n">Rectangle</span><span class="p">(</span><span class="n">width</span><span class="o">=</span><span class="mi">64</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">64</span><span class="p">,</span> <span class="n">tag</span><span class="o">=</span><span class="s2">&quot;player&quot;</span><span class="p">))</span>  <span class="c1"># This line should already be in your code</span>
<span class="c1"># add a ground detector</span>
<span class="n">player</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">rb</span><span class="o">.</span><span class="n">Rectangle</span><span class="p">(</span>
    <span class="n">width</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
    <span class="n">height</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
    <span class="n">offset</span><span class="o">=</span><span class="n">rb</span><span class="o">.</span><span class="n">Vector</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">32</span><span class="p">),</span>
    <span class="n">trigger</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">on_collide</span><span class="o">=</span><span class="n">player_collide</span><span class="p">,</span>
<span class="p">))</span>

<span class="c1"># create the ground</span>
<span class="n">ground</span> <span class="o">=</span> <span class="n">rb</span><span class="o">.</span><span class="n">GameObject</span><span class="p">()</span>
<span class="n">ground</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">rb</span><span class="o">.</span><span class="n">Rectangle</span><span class="p">(</span><span class="n">width</span><span class="o">=</span><span class="n">level_size</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">rb</span><span class="o">.</span><span class="n">Color</span><span class="o">.</span><span class="n">green</span><span class="p">,</span> <span class="n">tag</span><span class="o">=</span><span class="s2">&quot;ground&quot;</span><span class="p">))</span>
<span class="n">ground</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">rb</span><span class="o">.</span><span class="n">Rectangle</span><span class="p">)</span><span class="o">.</span><span class="n">bottom_left</span> <span class="o">=</span> <span class="n">rb</span><span class="o">.</span><span class="n">Display</span><span class="o">.</span><span class="n">bottom_left</span>

<span class="c1"># create platforms</span>
<span class="n">platforms</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">rb</span><span class="o">.</span><span class="n">GameObject</span><span class="p">(</span><span class="n">pos</span><span class="o">=</span><span class="n">rb</span><span class="o">.</span><span class="n">Vector</span><span class="p">(</span><span class="mi">200</span><span class="p">,</span> <span class="n">rb</span><span class="o">.</span><span class="n">Display</span><span class="o">.</span><span class="n">bottom</span> <span class="o">-</span> <span class="mi">140</span><span class="p">)</span>
                <span class="p">)</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">rb</span><span class="o">.</span><span class="n">Rectangle</span><span class="p">(</span>
                    <span class="n">width</span><span class="o">=</span><span class="mi">90</span><span class="p">,</span>
                    <span class="n">height</span><span class="o">=</span><span class="mi">40</span><span class="p">,</span>
                    <span class="n">tag</span><span class="o">=</span><span class="s2">&quot;ground&quot;</span><span class="p">,</span>
                    <span class="n">color</span><span class="o">=</span><span class="n">rb</span><span class="o">.</span><span class="n">Color</span><span class="o">.</span><span class="n">blue</span><span class="p">,</span>
                <span class="p">)),</span>
    <span class="n">rb</span><span class="o">.</span><span class="n">GameObject</span><span class="p">(</span><span class="n">pos</span><span class="o">=</span><span class="n">rb</span><span class="o">.</span><span class="n">Vector</span><span class="p">(</span><span class="mi">400</span><span class="p">,</span> <span class="n">rb</span><span class="o">.</span><span class="n">Display</span><span class="o">.</span><span class="n">bottom</span> <span class="o">-</span> <span class="mi">340</span><span class="p">)</span>
                <span class="p">)</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">rb</span><span class="o">.</span><span class="n">Rectangle</span><span class="p">(</span>
                    <span class="n">width</span><span class="o">=</span><span class="mi">150</span><span class="p">,</span>
                    <span class="n">height</span><span class="o">=</span><span class="mi">40</span><span class="p">,</span>
                    <span class="n">tag</span><span class="o">=</span><span class="s2">&quot;ground&quot;</span><span class="p">,</span>
                    <span class="n">color</span><span class="o">=</span><span class="n">rb</span><span class="o">.</span><span class="n">Color</span><span class="o">.</span><span class="n">blue</span><span class="p">,</span>
                <span class="p">)),</span>
<span class="p">]</span>

<span class="c1"># create obstacles</span>
<span class="n">obstacles</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">rb</span><span class="o">.</span><span class="n">GameObject</span><span class="p">(</span><span class="n">pos</span><span class="o">=</span><span class="n">rb</span><span class="o">.</span><span class="n">Vector</span><span class="p">(</span><span class="mi">700</span><span class="p">))</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">rb</span><span class="o">.</span><span class="n">Rectangle</span><span class="p">(</span>
        <span class="n">width</span><span class="o">=</span><span class="mi">90</span><span class="p">,</span>
        <span class="n">height</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span>
        <span class="n">tag</span><span class="o">=</span><span class="s2">&quot;ground&quot;</span><span class="p">,</span>
        <span class="n">color</span><span class="o">=</span><span class="n">rb</span><span class="o">.</span><span class="n">Color</span><span class="o">.</span><span class="n">purple</span><span class="p">,</span>
    <span class="p">)),</span>
    <span class="n">rb</span><span class="o">.</span><span class="n">GameObject</span><span class="p">(</span><span class="n">pos</span><span class="o">=</span><span class="n">rb</span><span class="o">.</span><span class="n">Vector</span><span class="p">(</span><span class="mi">1200</span><span class="p">))</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">rb</span><span class="o">.</span><span class="n">Rectangle</span><span class="p">(</span>
        <span class="n">width</span><span class="o">=</span><span class="mi">70</span><span class="p">,</span>
        <span class="n">height</span><span class="o">=</span><span class="mi">450</span><span class="p">,</span>
        <span class="n">tag</span><span class="o">=</span><span class="s2">&quot;ground&quot;</span><span class="p">,</span>
        <span class="n">color</span><span class="o">=</span><span class="n">rb</span><span class="o">.</span><span class="n">Color</span><span class="o">.</span><span class="n">purple</span><span class="p">,</span>
    <span class="p">)),</span>
<span class="p">]</span>

<span class="k">for</span> <span class="n">obstacle</span> <span class="ow">in</span> <span class="n">obstacles</span><span class="p">:</span>
    <span class="n">obstacle</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">rb</span><span class="o">.</span><span class="n">Rectangle</span><span class="p">)</span><span class="o">.</span><span class="n">bottom</span> <span class="o">=</span> <span class="n">rb</span><span class="o">.</span><span class="n">Display</span><span class="o">.</span><span class="n">bottom</span> <span class="o">-</span> <span class="mi">30</span>

<span class="c1"># Side boundary</span>
<span class="n">left</span> <span class="o">=</span> <span class="n">rb</span><span class="o">.</span><span class="n">GameObject</span><span class="p">(</span><span class="n">pos</span><span class="o">=</span><span class="n">rb</span><span class="o">.</span><span class="n">Display</span><span class="o">.</span><span class="n">center_left</span> <span class="o">-</span> <span class="n">rb</span><span class="o">.</span><span class="n">Vector</span><span class="p">(</span><span class="mi">25</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
<span class="n">left</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">rb</span><span class="o">.</span><span class="n">Rectangle</span><span class="p">(</span><span class="n">width</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="n">rb</span><span class="o">.</span><span class="n">Display</span><span class="o">.</span><span class="n">res</span><span class="o">.</span><span class="n">y</span><span class="p">))</span>
<span class="n">right</span> <span class="o">=</span> <span class="n">rb</span><span class="o">.</span><span class="n">GameObject</span><span class="p">(</span><span class="n">pos</span><span class="o">=</span><span class="n">rb</span><span class="o">.</span><span class="n">Display</span><span class="o">.</span><span class="n">center_left</span> <span class="o">+</span> <span class="n">rb</span><span class="o">.</span><span class="n">Vector</span><span class="p">(</span><span class="n">level_size</span> <span class="o">+</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
<span class="n">right</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">rb</span><span class="o">.</span><span class="n">Rectangle</span><span class="p">(</span><span class="n">width</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="n">rb</span><span class="o">.</span><span class="n">Display</span><span class="o">.</span><span class="n">res</span><span class="o">.</span><span class="n">y</span><span class="p">))</span>

<span class="c1"># add them all to the scene</span>
<span class="n">main</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">player</span><span class="p">,</span> <span class="n">ground</span><span class="p">,</span> <span class="n">left</span><span class="p">,</span> <span class="n">right</span><span class="p">,</span> <span class="o">*</span><span class="n">platforms</span><span class="p">,</span> <span class="o">*</span><span class="n">obstacles</span><span class="p">)</span>


<span class="c1"># define a custom update function</span>
<span class="c1"># this function is run every frame</span>
<span class="k">def</span> <span class="nf">update</span><span class="p">():</span>
    <span class="k">if</span> <span class="n">rb</span><span class="o">.</span><span class="n">Input</span><span class="o">.</span><span class="n">key_pressed</span><span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">):</span>
        <span class="n">player_body</span><span class="o">.</span><span class="n">velocity</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="o">-</span><span class="mi">300</span>
        <span class="n">p_animation</span><span class="o">.</span><span class="n">flipx</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="k">elif</span> <span class="n">rb</span><span class="o">.</span><span class="n">Input</span><span class="o">.</span><span class="n">key_pressed</span><span class="p">(</span><span class="s2">&quot;d&quot;</span><span class="p">):</span>
        <span class="n">player_body</span><span class="o">.</span><span class="n">velocity</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="mi">300</span>
        <span class="n">p_animation</span><span class="o">.</span><span class="n">flipx</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">player_body</span><span class="o">.</span><span class="n">velocity</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="k">if</span> <span class="n">rb</span><span class="o">.</span><span class="n">Input</span><span class="o">.</span><span class="n">key_pressed</span><span class="p">(</span><span class="s2">&quot;space&quot;</span><span class="p">):</span>
        <span class="n">player_body</span><span class="o">.</span><span class="n">ang_vel</span> <span class="o">+=</span> <span class="mi">10</span>


<span class="c1"># define a custom fixed update function</span>
<span class="k">def</span> <span class="nf">fixed_update</span><span class="p">():</span>
    <span class="c1"># have the camera follow the player</span>
    <span class="n">camera_ideal</span> <span class="o">=</span> <span class="n">rb</span><span class="o">.</span><span class="n">Math</span><span class="o">.</span><span class="n">clamp</span><span class="p">(</span>
        <span class="n">player</span><span class="o">.</span><span class="n">pos</span><span class="o">.</span><span class="n">x</span> <span class="o">+</span> <span class="n">rb</span><span class="o">.</span><span class="n">Display</span><span class="o">.</span><span class="n">res</span><span class="o">.</span><span class="n">x</span> <span class="o">/</span> <span class="mi">4</span><span class="p">,</span> <span class="n">rb</span><span class="o">.</span><span class="n">Display</span><span class="o">.</span><span class="n">center</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">level_size</span> <span class="o">-</span> <span class="n">rb</span><span class="o">.</span><span class="n">Display</span><span class="o">.</span><span class="n">res</span><span class="o">.</span><span class="n">x</span> <span class="o">/</span> <span class="mi">2</span>
    <span class="p">)</span>
    <span class="n">rb</span><span class="o">.</span><span class="n">Game</span><span class="o">.</span><span class="n">camera</span><span class="o">.</span><span class="n">pos</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">rb</span><span class="o">.</span><span class="n">Math</span><span class="o">.</span><span class="n">lerp</span><span class="p">(</span><span class="n">rb</span><span class="o">.</span><span class="n">Game</span><span class="o">.</span><span class="n">camera</span><span class="o">.</span><span class="n">pos</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">camera_ideal</span><span class="p">,</span> <span class="n">rb</span><span class="o">.</span><span class="n">Time</span><span class="o">.</span><span class="n">fixed_delta</span> <span class="o">/</span> <span class="mf">0.4</span><span class="p">)</span>


<span class="c1"># set the scene&#39;s update function</span>
<span class="n">main</span><span class="o">.</span><span class="n">update</span> <span class="o">=</span> <span class="n">update</span>
<span class="n">main</span><span class="o">.</span><span class="n">fixed_update</span> <span class="o">=</span> <span class="n">fixed_update</span>


<span class="c1"># define a custom input listener</span>
<span class="k">def</span> <span class="nf">handle_keydown</span><span class="p">(</span><span class="n">event</span><span class="p">):</span>
    <span class="k">global</span> <span class="n">jumps</span><span class="p">,</span> <span class="n">grounded</span>
    <span class="k">if</span> <span class="n">event</span><span class="p">[</span><span class="s2">&quot;key&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;w&quot;</span> <span class="ow">and</span> <span class="n">jumps</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">grounded</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="n">player_body</span><span class="o">.</span><span class="n">velocity</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="o">-</span><span class="mi">800</span>
        <span class="k">if</span> <span class="n">jumps</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
            <span class="n">p_animation</span><span class="o">.</span><span class="n">set_state</span><span class="p">(</span><span class="s2">&quot;jump&quot;</span><span class="p">,</span> <span class="n">freeze</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">jumps</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">p_animation</span><span class="o">.</span><span class="n">set_state</span><span class="p">(</span><span class="s2">&quot;somer&quot;</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
        <span class="n">jumps</span> <span class="o">-=</span> <span class="mi">1</span>


<span class="n">rb</span><span class="o">.</span><span class="n">Radio</span><span class="o">.</span><span class="n">listen</span><span class="p">(</span><span class="s2">&quot;KEYDOWN&quot;</span><span class="p">,</span> <span class="n">handle_keydown</span><span class="p">)</span>

<span class="c1"># begin the game</span>
<span class="n">rb</span><span class="o">.</span><span class="n">begin</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details><p>We're also including a version with some more in-depth features that weren't covered in this tutorial, including
win detection, advanced animation switching, and a respawn system.</p>
<details class="sd-sphinx-override sd-dropdown sd-card sd-mb-3">
<summary class="sd-summary-title sd-card-header">
Here is what that code looks like:<div class="sd-summary-down docutils">
<svg version="1.1" width="1.5em" height="1.5em" class="sd-octicon sd-octicon-chevron-down" viewBox="0 0 24 24" aria-hidden="true"><path fill-rule="evenodd" d="M5.22 8.72a.75.75 0 000 1.06l6.25 6.25a.75.75 0 001.06 0l6.25-6.25a.75.75 0 00-1.06-1.06L12 14.44 6.28 8.72a.75.75 0 00-1.06 0z"></path></svg></div>
<div class="sd-summary-up docutils">
<svg version="1.1" width="1.5em" height="1.5em" class="sd-octicon sd-octicon-chevron-up" viewBox="0 0 24 24" aria-hidden="true"><path fill-rule="evenodd" d="M18.78 15.28a.75.75 0 000-1.06l-6.25-6.25a.75.75 0 00-1.06 0l-6.25 6.25a.75.75 0 101.06 1.06L12 9.56l5.72 5.72a.75.75 0 001.06 0z"></path></svg></div>
</summary><div class="sd-summary-content sd-card-body docutils">
<div class="literal-block-wrapper docutils container" id="id1">
<div class="code-block-caption"><span class="caption-text">platformer.py</span><a class="headerlink" href="#id1" title="Permalink to this code">#</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">rubato</span> <span class="k">as</span> <span class="nn">rb</span>

<span class="c1"># initialize a new game</span>
<span class="n">rb</span><span class="o">.</span><span class="n">init</span><span class="p">(</span>
    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Platformer Demo&quot;</span><span class="p">,</span>  <span class="c1"># Set a name</span>
    <span class="n">res</span><span class="o">=</span><span class="n">rb</span><span class="o">.</span><span class="n">Vector</span><span class="p">(</span><span class="mi">1920</span><span class="p">,</span> <span class="mi">1080</span><span class="p">),</span>  <span class="c1"># Increase the window resolution</span>
<span class="p">)</span>

<span class="c1"># Change the global debug level</span>
<span class="c1"># rb.Game.debug = True</span>
<span class="c1"># rb.Game.show_fps = True</span>

<span class="c1"># Tracks the grounded state of the player</span>
<span class="n">grounded</span> <span class="o">=</span> <span class="kc">False</span>
<span class="c1"># Tracks the number of jumps the player has left</span>
<span class="n">jumps</span> <span class="o">=</span> <span class="mi">0</span>
<span class="c1"># size of level</span>
<span class="n">level_size</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">rb</span><span class="o">.</span><span class="n">Display</span><span class="o">.</span><span class="n">res</span><span class="o">.</span><span class="n">x</span> <span class="o">*</span> <span class="mf">1.2</span><span class="p">)</span>

<span class="c1"># create the scene for level one</span>
<span class="n">main</span> <span class="o">=</span> <span class="n">rb</span><span class="o">.</span><span class="n">Scene</span><span class="p">(</span><span class="n">background_color</span><span class="o">=</span><span class="n">rb</span><span class="o">.</span><span class="n">Color</span><span class="o">.</span><span class="n">cyan</span><span class="o">.</span><span class="n">lighter</span><span class="p">())</span>

<span class="c1"># Create the player and set its starting position</span>
<span class="n">player</span> <span class="o">=</span> <span class="n">rb</span><span class="o">.</span><span class="n">GameObject</span><span class="p">(</span>
    <span class="n">pos</span><span class="o">=</span><span class="n">rb</span><span class="o">.</span><span class="n">Display</span><span class="o">.</span><span class="n">center_left</span> <span class="o">+</span> <span class="n">rb</span><span class="o">.</span><span class="n">Vector</span><span class="p">(</span><span class="mi">50</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
    <span class="n">z_index</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
<span class="p">)</span>

<span class="c1"># Create animation and initialize states</span>
<span class="n">p_animation</span> <span class="o">=</span> <span class="n">rb</span><span class="o">.</span><span class="n">Spritesheet</span><span class="o">.</span><span class="n">from_folder</span><span class="p">(</span>
    <span class="n">path</span><span class="o">=</span><span class="s2">&quot;files/dino&quot;</span><span class="p">,</span>
    <span class="n">sprite_size</span><span class="o">=</span><span class="n">rb</span><span class="o">.</span><span class="n">Vector</span><span class="p">(</span><span class="mi">24</span><span class="p">,</span> <span class="mi">24</span><span class="p">),</span>
    <span class="n">default_state</span><span class="o">=</span><span class="s2">&quot;idle&quot;</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">p_animation</span><span class="o">.</span><span class="n">scale</span> <span class="o">=</span> <span class="n">rb</span><span class="o">.</span><span class="n">Vector</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="n">p_animation</span><span class="o">.</span><span class="n">fps</span> <span class="o">=</span> <span class="mi">10</span>  <span class="c1"># The frames will change 10 times a second</span>
<span class="n">player</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">p_animation</span><span class="p">)</span>  <span class="c1"># Add the animation component to the player</span>

<span class="c1"># define a collision handler</span>
<span class="n">won</span> <span class="o">=</span> <span class="kc">False</span>
<span class="n">retry_allowed</span> <span class="o">=</span> <span class="kc">True</span>


<span class="k">def</span> <span class="nf">player_collide</span><span class="p">(</span><span class="n">col_info</span><span class="p">:</span> <span class="n">rb</span><span class="o">.</span><span class="n">Manifold</span><span class="p">):</span>
    <span class="k">global</span> <span class="n">jumps</span><span class="p">,</span> <span class="n">grounded</span><span class="p">,</span> <span class="n">won</span><span class="p">,</span> <span class="n">retry_allowed</span>
    <span class="k">if</span> <span class="n">col_info</span><span class="o">.</span><span class="n">shape_b</span><span class="o">.</span><span class="n">tag</span> <span class="o">==</span> <span class="s2">&quot;ground&quot;</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">grounded</span> <span class="ow">and</span> <span class="n">player_body</span><span class="o">.</span><span class="n">velocity</span><span class="o">.</span><span class="n">y</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">grounded</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="n">jumps</span> <span class="o">=</span> <span class="mi">2</span>
        <span class="n">p_animation</span><span class="o">.</span><span class="n">set_state</span><span class="p">(</span><span class="s2">&quot;idle&quot;</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">col_info</span><span class="o">.</span><span class="n">shape_b</span><span class="o">.</span><span class="n">tag</span> <span class="o">==</span> <span class="s2">&quot;retry_collider&quot;</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">retry_allowed</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;r to retry&quot;</span><span class="p">)</span>
            <span class="n">retry_allowed</span> <span class="o">=</span> <span class="kc">False</span>

            <span class="k">def</span> <span class="nf">re_allow</span><span class="p">():</span>
                <span class="k">global</span> <span class="n">retry_allowed</span>
                <span class="n">retry_allowed</span> <span class="o">=</span> <span class="kc">True</span>

            <span class="n">rb</span><span class="o">.</span><span class="n">Time</span><span class="o">.</span><span class="n">delayed_call</span><span class="p">(</span><span class="mi">2000</span><span class="p">,</span> <span class="n">re_allow</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">col_info</span><span class="o">.</span><span class="n">shape_b</span><span class="o">.</span><span class="n">tag</span> <span class="o">==</span> <span class="s2">&quot;portal&quot;</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">won</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;WIN!&quot;</span><span class="p">)</span>
            <span class="n">won</span> <span class="o">=</span> <span class="kc">True</span>


<span class="c1"># add a hitbox to the player with the collider</span>
<span class="n">player</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">rb</span><span class="o">.</span><span class="n">Rectangle</span><span class="p">(</span><span class="n">width</span><span class="o">=</span><span class="mi">40</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">64</span><span class="p">,</span> <span class="n">tag</span><span class="o">=</span><span class="s2">&quot;player&quot;</span><span class="p">))</span>
<span class="c1"># add a ground detector</span>
<span class="n">player</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">rb</span><span class="o">.</span><span class="n">Rectangle</span><span class="p">(</span>
    <span class="n">width</span><span class="o">=</span><span class="mi">34</span><span class="p">,</span>
    <span class="n">height</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
    <span class="n">offset</span><span class="o">=</span><span class="n">rb</span><span class="o">.</span><span class="n">Vector</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">32</span><span class="p">),</span>
    <span class="n">trigger</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">on_collide</span><span class="o">=</span><span class="n">player_collide</span><span class="p">,</span>
<span class="p">))</span>

<span class="c1"># define the player rigidbody</span>
<span class="n">player_body</span> <span class="o">=</span> <span class="n">rb</span><span class="o">.</span><span class="n">RigidBody</span><span class="p">(</span><span class="n">gravity</span><span class="o">=</span><span class="n">rb</span><span class="o">.</span><span class="n">Vector</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">rb</span><span class="o">.</span><span class="n">Display</span><span class="o">.</span><span class="n">res</span><span class="o">.</span><span class="n">y</span> <span class="o">*</span> <span class="mf">1.5</span><span class="p">),</span> <span class="n">pos_correction</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">player</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">player_body</span><span class="p">)</span>

<span class="c1"># Side boundary</span>
<span class="n">left</span> <span class="o">=</span> <span class="n">rb</span><span class="o">.</span><span class="n">GameObject</span><span class="p">(</span><span class="n">pos</span><span class="o">=</span><span class="n">rb</span><span class="o">.</span><span class="n">Display</span><span class="o">.</span><span class="n">center_left</span> <span class="o">-</span> <span class="n">rb</span><span class="o">.</span><span class="n">Vector</span><span class="p">(</span><span class="mi">25</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
<span class="n">left</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">rb</span><span class="o">.</span><span class="n">Rectangle</span><span class="p">(</span><span class="n">width</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="n">rb</span><span class="o">.</span><span class="n">Display</span><span class="o">.</span><span class="n">res</span><span class="o">.</span><span class="n">y</span><span class="p">))</span>
<span class="n">right</span> <span class="o">=</span> <span class="n">rb</span><span class="o">.</span><span class="n">GameObject</span><span class="p">(</span><span class="n">pos</span><span class="o">=</span><span class="n">rb</span><span class="o">.</span><span class="n">Display</span><span class="o">.</span><span class="n">center_left</span> <span class="o">+</span> <span class="n">rb</span><span class="o">.</span><span class="n">Vector</span><span class="p">(</span><span class="n">level_size</span> <span class="o">+</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
<span class="n">right</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">rb</span><span class="o">.</span><span class="n">Rectangle</span><span class="p">(</span><span class="n">width</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="n">rb</span><span class="o">.</span><span class="n">Display</span><span class="o">.</span><span class="n">res</span><span class="o">.</span><span class="n">y</span><span class="p">))</span>

<span class="c1"># create the ground</span>
<span class="n">ground</span> <span class="o">=</span> <span class="n">rb</span><span class="o">.</span><span class="n">GameObject</span><span class="p">()</span>
<span class="n">ground</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">rb</span><span class="o">.</span><span class="n">Rectangle</span><span class="p">(</span><span class="n">width</span><span class="o">=</span><span class="n">level_size</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">rb</span><span class="o">.</span><span class="n">Color</span><span class="o">.</span><span class="n">green</span><span class="p">,</span> <span class="n">tag</span><span class="o">=</span><span class="s2">&quot;ground&quot;</span><span class="p">))</span>
<span class="n">ground</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">rb</span><span class="o">.</span><span class="n">Rectangle</span><span class="p">)</span><span class="o">.</span><span class="n">bottom_left</span> <span class="o">=</span> <span class="n">rb</span><span class="o">.</span><span class="n">Display</span><span class="o">.</span><span class="n">bottom_left</span>

<span class="c1"># create platforms</span>
<span class="n">platforms</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">rb</span><span class="o">.</span><span class="n">GameObject</span><span class="p">(</span><span class="n">pos</span><span class="o">=</span><span class="n">rb</span><span class="o">.</span><span class="n">Vector</span><span class="p">(</span>
        <span class="mi">200</span><span class="p">,</span>
        <span class="n">rb</span><span class="o">.</span><span class="n">Display</span><span class="o">.</span><span class="n">bottom</span> <span class="o">-</span> <span class="mi">140</span><span class="p">,</span>
    <span class="p">))</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">rb</span><span class="o">.</span><span class="n">Rectangle</span><span class="p">(</span>
        <span class="n">width</span><span class="o">=</span><span class="mi">90</span><span class="p">,</span>
        <span class="n">height</span><span class="o">=</span><span class="mi">40</span><span class="p">,</span>
        <span class="n">tag</span><span class="o">=</span><span class="s2">&quot;ground&quot;</span><span class="p">,</span>
        <span class="n">color</span><span class="o">=</span><span class="n">rb</span><span class="o">.</span><span class="n">Color</span><span class="o">.</span><span class="n">blue</span><span class="p">,</span>
    <span class="p">)),</span>
    <span class="n">rb</span><span class="o">.</span><span class="n">GameObject</span><span class="p">(</span><span class="n">pos</span><span class="o">=</span><span class="n">rb</span><span class="o">.</span><span class="n">Vector</span><span class="p">(</span>
        <span class="mi">400</span><span class="p">,</span>
        <span class="n">rb</span><span class="o">.</span><span class="n">Display</span><span class="o">.</span><span class="n">bottom</span> <span class="o">-</span> <span class="mi">340</span><span class="p">,</span>
    <span class="p">))</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">rb</span><span class="o">.</span><span class="n">Rectangle</span><span class="p">(</span>
        <span class="n">width</span><span class="o">=</span><span class="mi">150</span><span class="p">,</span>
        <span class="n">height</span><span class="o">=</span><span class="mi">40</span><span class="p">,</span>
        <span class="n">tag</span><span class="o">=</span><span class="s2">&quot;ground&quot;</span><span class="p">,</span>
        <span class="n">color</span><span class="o">=</span><span class="n">rb</span><span class="o">.</span><span class="n">Color</span><span class="o">.</span><span class="n">blue</span><span class="p">,</span>
    <span class="p">)),</span>
<span class="p">]</span>

<span class="c1"># create obstacles</span>
<span class="n">obstacles</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">rb</span><span class="o">.</span><span class="n">GameObject</span><span class="p">(</span><span class="n">pos</span><span class="o">=</span><span class="n">rb</span><span class="o">.</span><span class="n">Vector</span><span class="p">(</span><span class="mi">700</span><span class="p">))</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">rb</span><span class="o">.</span><span class="n">Rectangle</span><span class="p">(</span>
        <span class="n">width</span><span class="o">=</span><span class="mi">90</span><span class="p">,</span>
        <span class="n">height</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span>
        <span class="n">tag</span><span class="o">=</span><span class="s2">&quot;ground&quot;</span><span class="p">,</span>
        <span class="n">color</span><span class="o">=</span><span class="n">rb</span><span class="o">.</span><span class="n">Color</span><span class="o">.</span><span class="n">purple</span><span class="p">,</span>
    <span class="p">)),</span>
    <span class="n">rb</span><span class="o">.</span><span class="n">GameObject</span><span class="p">(</span><span class="n">pos</span><span class="o">=</span><span class="n">rb</span><span class="o">.</span><span class="n">Vector</span><span class="p">(</span><span class="mi">1200</span><span class="p">))</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">rb</span><span class="o">.</span><span class="n">Rectangle</span><span class="p">(</span>
        <span class="n">width</span><span class="o">=</span><span class="mi">70</span><span class="p">,</span>
        <span class="n">height</span><span class="o">=</span><span class="mi">450</span><span class="p">,</span>
        <span class="n">tag</span><span class="o">=</span><span class="s2">&quot;ground&quot;</span><span class="p">,</span>
        <span class="n">color</span><span class="o">=</span><span class="n">rb</span><span class="o">.</span><span class="n">Color</span><span class="o">.</span><span class="n">purple</span><span class="p">,</span>
    <span class="p">)),</span>
<span class="p">]</span>

<span class="k">for</span> <span class="n">obstacle</span> <span class="ow">in</span> <span class="n">obstacles</span><span class="p">:</span>
    <span class="n">obstacle</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">rb</span><span class="o">.</span><span class="n">Rectangle</span><span class="p">)</span><span class="o">.</span><span class="n">bottom</span> <span class="o">=</span> <span class="n">rb</span><span class="o">.</span><span class="n">Display</span><span class="o">.</span><span class="n">bottom</span> <span class="o">-</span> <span class="mi">30</span>

<span class="c1"># create triggers</span>
<span class="n">triggers</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">rb</span><span class="o">.</span><span class="n">GameObject</span><span class="p">(</span><span class="n">pos</span><span class="o">=</span><span class="n">rb</span><span class="o">.</span><span class="n">Vector</span><span class="p">(</span>
        <span class="mi">950</span><span class="p">,</span>
        <span class="n">rb</span><span class="o">.</span><span class="n">Display</span><span class="o">.</span><span class="n">bottom</span> <span class="o">-</span> <span class="mi">45</span><span class="p">,</span>
    <span class="p">))</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">rb</span><span class="o">.</span><span class="n">Rectangle</span><span class="p">(</span>
        <span class="n">width</span><span class="o">=</span><span class="mi">400</span><span class="p">,</span>
        <span class="n">height</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span>
        <span class="n">tag</span><span class="o">=</span><span class="s2">&quot;retry_collider&quot;</span><span class="p">,</span>
        <span class="n">trigger</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="p">)),</span>
<span class="p">]</span>

<span class="c1"># Create animation for portal</span>
<span class="n">all_portal_images</span> <span class="o">=</span> <span class="n">rb</span><span class="o">.</span><span class="n">Spritesheet</span><span class="p">(</span>
    <span class="n">path</span><span class="o">=</span><span class="s2">&quot;files/portals/portal1_spritesheet.png&quot;</span><span class="p">,</span>
    <span class="n">sprite_size</span><span class="o">=</span><span class="n">rb</span><span class="o">.</span><span class="n">Vector</span><span class="p">(</span><span class="mi">32</span><span class="p">,</span> <span class="mi">32</span><span class="p">),</span>
    <span class="n">grid_size</span><span class="o">=</span><span class="n">rb</span><span class="o">.</span><span class="n">Vector</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
<span class="p">)</span>

<span class="n">portal_animation</span> <span class="o">=</span> <span class="n">rb</span><span class="o">.</span><span class="n">Animation</span><span class="p">(</span><span class="n">scale</span><span class="o">=</span><span class="n">rb</span><span class="o">.</span><span class="n">Vector</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="n">fps</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">portal_animation</span><span class="o">.</span><span class="n">add_spritesheet</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">all_portal_images</span><span class="p">,</span> <span class="n">to_coord</span><span class="o">=</span><span class="n">all_portal_images</span><span class="o">.</span><span class="n">end</span><span class="p">)</span>

<span class="c1"># create the end portal</span>
<span class="n">portal</span> <span class="o">=</span> <span class="n">rb</span><span class="o">.</span><span class="n">GameObject</span><span class="p">(</span><span class="n">pos</span><span class="o">=</span><span class="n">rb</span><span class="o">.</span><span class="n">Display</span><span class="o">.</span><span class="n">bottom_left</span> <span class="o">+</span> <span class="n">rb</span><span class="o">.</span><span class="n">Vector</span><span class="p">(</span><span class="n">level_size</span> <span class="o">-</span> <span class="mi">50</span><span class="p">,</span> <span class="o">-</span><span class="mi">100</span><span class="p">))</span>
<span class="n">portal</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">portal_animation</span><span class="p">)</span>

<span class="n">portal</span><span class="o">.</span><span class="n">add</span><span class="p">(</span>
    <span class="n">rb</span><span class="o">.</span><span class="n">Rectangle</span><span class="p">(</span>
        <span class="n">trigger</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">tag</span><span class="o">=</span><span class="s2">&quot;portal&quot;</span><span class="p">,</span>
        <span class="n">width</span><span class="o">=</span><span class="n">portal_animation</span><span class="o">.</span><span class="n">anim_frame</span><span class="p">()</span><span class="o">.</span><span class="n">get_size</span><span class="p">()</span><span class="o">.</span><span class="n">x</span><span class="p">,</span>
        <span class="n">height</span><span class="o">=</span><span class="n">portal_animation</span><span class="o">.</span><span class="n">anim_frame</span><span class="p">()</span><span class="o">.</span><span class="n">get_size</span><span class="p">()</span><span class="o">.</span><span class="n">y</span><span class="p">,</span>
    <span class="p">)</span>
<span class="p">)</span>

<span class="c1"># add them all to the scene</span>
<span class="n">main</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">player</span><span class="p">,</span> <span class="n">ground</span><span class="p">,</span> <span class="n">left</span><span class="p">,</span> <span class="n">right</span><span class="p">,</span> <span class="n">portal</span><span class="p">,</span> <span class="o">*</span><span class="n">platforms</span><span class="p">,</span> <span class="o">*</span><span class="n">obstacles</span><span class="p">,</span> <span class="o">*</span><span class="n">triggers</span><span class="p">)</span>


<span class="c1"># define a custom update function</span>
<span class="c1"># this function is run every frame</span>
<span class="k">def</span> <span class="nf">update</span><span class="p">():</span>
    <span class="k">global</span> <span class="n">grounded</span>

    <span class="n">move_axis</span> <span class="o">=</span> <span class="n">rb</span><span class="o">.</span><span class="n">Input</span><span class="o">.</span><span class="n">controller_axis</span><span class="p">(</span><span class="n">rb</span><span class="o">.</span><span class="n">Input</span><span class="o">.</span><span class="n">controllers</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
    <span class="n">centered</span> <span class="o">=</span> <span class="n">rb</span><span class="o">.</span><span class="n">Input</span><span class="o">.</span><span class="n">axis_centered</span><span class="p">(</span><span class="n">move_axis</span><span class="p">)</span>

    <span class="c1"># check for user directional input</span>
    <span class="k">if</span> <span class="n">rb</span><span class="o">.</span><span class="n">Input</span><span class="o">.</span><span class="n">key_pressed</span><span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">move_axis</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">centered</span><span class="p">):</span>
        <span class="n">player_body</span><span class="o">.</span><span class="n">velocity</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="o">-</span><span class="mi">300</span>
        <span class="n">p_animation</span><span class="o">.</span><span class="n">flipx</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">if</span> <span class="n">grounded</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">rb</span><span class="o">.</span><span class="n">Input</span><span class="o">.</span><span class="n">key_pressed</span><span class="p">(</span><span class="s2">&quot;shift&quot;</span><span class="p">)</span> <span class="ow">or</span> <span class="n">rb</span><span class="o">.</span><span class="n">Input</span><span class="o">.</span><span class="n">key_pressed</span><span class="p">(</span><span class="s2">&quot;s&quot;</span><span class="p">):</span>
                <span class="n">p_animation</span><span class="o">.</span><span class="n">set_state</span><span class="p">(</span><span class="s2">&quot;sneak&quot;</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">p_animation</span><span class="o">.</span><span class="n">set_state</span><span class="p">(</span><span class="s2">&quot;run&quot;</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">rb</span><span class="o">.</span><span class="n">Input</span><span class="o">.</span><span class="n">key_pressed</span><span class="p">(</span><span class="s2">&quot;d&quot;</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">move_axis</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">centered</span><span class="p">):</span>
        <span class="n">player_body</span><span class="o">.</span><span class="n">velocity</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="mi">300</span>
        <span class="n">p_animation</span><span class="o">.</span><span class="n">flipx</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">if</span> <span class="n">grounded</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">rb</span><span class="o">.</span><span class="n">Input</span><span class="o">.</span><span class="n">key_pressed</span><span class="p">(</span><span class="s2">&quot;shift&quot;</span><span class="p">)</span> <span class="ow">or</span> <span class="n">rb</span><span class="o">.</span><span class="n">Input</span><span class="o">.</span><span class="n">key_pressed</span><span class="p">(</span><span class="s2">&quot;s&quot;</span><span class="p">):</span>
                <span class="n">p_animation</span><span class="o">.</span><span class="n">set_state</span><span class="p">(</span><span class="s2">&quot;sneak&quot;</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">p_animation</span><span class="o">.</span><span class="n">set_state</span><span class="p">(</span><span class="s2">&quot;run&quot;</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">player_body</span><span class="o">.</span><span class="n">velocity</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">if</span> <span class="n">grounded</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">rb</span><span class="o">.</span><span class="n">Input</span><span class="o">.</span><span class="n">key_pressed</span><span class="p">(</span><span class="s2">&quot;shift&quot;</span><span class="p">)</span> <span class="ow">or</span> <span class="n">rb</span><span class="o">.</span><span class="n">Input</span><span class="o">.</span><span class="n">key_pressed</span><span class="p">(</span><span class="s2">&quot;s&quot;</span><span class="p">):</span>
                <span class="n">p_animation</span><span class="o">.</span><span class="n">set_state</span><span class="p">(</span><span class="s2">&quot;crouch&quot;</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">p_animation</span><span class="o">.</span><span class="n">set_state</span><span class="p">(</span><span class="s2">&quot;idle&quot;</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">rb</span><span class="o">.</span><span class="n">Input</span><span class="o">.</span><span class="n">key_pressed</span><span class="p">(</span><span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="ow">or</span> <span class="n">rb</span><span class="o">.</span><span class="n">Input</span><span class="o">.</span><span class="n">controller_button</span><span class="p">(</span><span class="n">rb</span><span class="o">.</span><span class="n">Input</span><span class="o">.</span><span class="n">controllers</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">):</span>
        <span class="n">player</span><span class="o">.</span><span class="n">pos</span> <span class="o">=</span> <span class="n">rb</span><span class="o">.</span><span class="n">Display</span><span class="o">.</span><span class="n">center_left</span> <span class="o">+</span> <span class="n">rb</span><span class="o">.</span><span class="n">Vector</span><span class="p">(</span><span class="mi">50</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="n">player</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">rb</span><span class="o">.</span><span class="n">RigidBody</span><span class="p">)</span><span class="o">.</span><span class="n">velocity</span> <span class="o">=</span> <span class="n">rb</span><span class="o">.</span><span class="n">Vector</span><span class="o">.</span><span class="n">zero</span><span class="p">()</span>
        <span class="n">grounded</span> <span class="o">=</span> <span class="kc">False</span>

    <span class="k">if</span> <span class="n">rb</span><span class="o">.</span><span class="n">Input</span><span class="o">.</span><span class="n">key_pressed</span><span class="p">(</span><span class="s2">&quot;space&quot;</span><span class="p">):</span>
        <span class="n">player_body</span><span class="o">.</span><span class="n">ang_vel</span> <span class="o">+=</span> <span class="mi">10</span>


<span class="c1"># define a custom fixed update function</span>
<span class="k">def</span> <span class="nf">fixed_update</span><span class="p">():</span>
    <span class="c1"># have the camera follow the player</span>
    <span class="n">camera_ideal</span> <span class="o">=</span> <span class="n">rb</span><span class="o">.</span><span class="n">Math</span><span class="o">.</span><span class="n">clamp</span><span class="p">(</span>
        <span class="n">player</span><span class="o">.</span><span class="n">pos</span><span class="o">.</span><span class="n">x</span> <span class="o">+</span> <span class="n">rb</span><span class="o">.</span><span class="n">Display</span><span class="o">.</span><span class="n">res</span><span class="o">.</span><span class="n">x</span> <span class="o">/</span> <span class="mi">4</span><span class="p">,</span> <span class="n">rb</span><span class="o">.</span><span class="n">Display</span><span class="o">.</span><span class="n">center</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">level_size</span> <span class="o">-</span> <span class="n">rb</span><span class="o">.</span><span class="n">Display</span><span class="o">.</span><span class="n">res</span><span class="o">.</span><span class="n">x</span> <span class="o">/</span> <span class="mi">2</span>
    <span class="p">)</span>
    <span class="n">rb</span><span class="o">.</span><span class="n">Game</span><span class="o">.</span><span class="n">camera</span><span class="o">.</span><span class="n">pos</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">rb</span><span class="o">.</span><span class="n">Math</span><span class="o">.</span><span class="n">lerp</span><span class="p">(</span><span class="n">rb</span><span class="o">.</span><span class="n">Game</span><span class="o">.</span><span class="n">camera</span><span class="o">.</span><span class="n">pos</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">camera_ideal</span><span class="p">,</span> <span class="n">rb</span><span class="o">.</span><span class="n">Time</span><span class="o">.</span><span class="n">fixed_delta</span> <span class="o">/</span> <span class="mf">0.4</span><span class="p">)</span>


<span class="c1"># set the scene&#39;s update function</span>
<span class="n">main</span><span class="o">.</span><span class="n">update</span> <span class="o">=</span> <span class="n">update</span>
<span class="n">main</span><span class="o">.</span><span class="n">fixed_update</span> <span class="o">=</span> <span class="n">fixed_update</span>


<span class="c1"># define a custom input listener</span>
<span class="k">def</span> <span class="nf">handle_keydown</span><span class="p">(</span><span class="n">event</span><span class="p">):</span>
    <span class="k">global</span> <span class="n">jumps</span><span class="p">,</span> <span class="n">grounded</span>
    <span class="k">if</span> <span class="n">event</span><span class="p">[</span><span class="s2">&quot;key&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;w&quot;</span> <span class="ow">and</span> <span class="n">jumps</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">grounded</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="n">player_body</span><span class="o">.</span><span class="n">velocity</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="o">-</span><span class="mi">800</span>
        <span class="k">if</span> <span class="n">jumps</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
            <span class="n">p_animation</span><span class="o">.</span><span class="n">set_state</span><span class="p">(</span><span class="s2">&quot;jump&quot;</span><span class="p">,</span> <span class="n">freeze</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">jumps</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">p_animation</span><span class="o">.</span><span class="n">set_state</span><span class="p">(</span><span class="s2">&quot;somer&quot;</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
        <span class="n">jumps</span> <span class="o">-=</span> <span class="mi">1</span>
    <span class="k">if</span> <span class="n">event</span><span class="p">[</span><span class="s2">&quot;key&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;1&quot;</span><span class="p">:</span>
        <span class="n">rb</span><span class="o">.</span><span class="n">Game</span><span class="o">.</span><span class="n">camera</span><span class="o">.</span><span class="n">zoom</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="k">if</span> <span class="n">event</span><span class="p">[</span><span class="s2">&quot;key&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;2&quot;</span><span class="p">:</span>
        <span class="n">rb</span><span class="o">.</span><span class="n">Game</span><span class="o">.</span><span class="n">camera</span><span class="o">.</span><span class="n">zoom</span> <span class="o">=</span> <span class="mi">2</span>
    <span class="k">if</span> <span class="n">event</span><span class="p">[</span><span class="s2">&quot;key&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;3&quot;</span><span class="p">:</span>
        <span class="n">rb</span><span class="o">.</span><span class="n">Game</span><span class="o">.</span><span class="n">camera</span><span class="o">.</span><span class="n">zoom</span> <span class="o">=</span> <span class="mf">.5</span>


<span class="c1"># define a custom controller listener</span>
<span class="k">def</span> <span class="nf">handle_controller_button</span><span class="p">(</span><span class="n">event</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">event</span><span class="p">[</span><span class="s2">&quot;button&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">handle_keydown</span><span class="p">({</span><span class="s2">&quot;key&quot;</span><span class="p">:</span> <span class="s2">&quot;w&quot;</span><span class="p">})</span>


<span class="n">rb</span><span class="o">.</span><span class="n">Radio</span><span class="o">.</span><span class="n">listen</span><span class="p">(</span><span class="n">rb</span><span class="o">.</span><span class="n">Events</span><span class="o">.</span><span class="n">KEYDOWN</span><span class="p">,</span> <span class="n">handle_keydown</span><span class="p">)</span>

<span class="n">rb</span><span class="o">.</span><span class="n">Radio</span><span class="o">.</span><span class="n">listen</span><span class="p">(</span><span class="n">rb</span><span class="o">.</span><span class="n">Events</span><span class="o">.</span><span class="n">JOYBUTTONDOWN</span><span class="p">,</span> <span class="n">handle_controller_button</span><span class="p">)</span>

<span class="c1"># begin the game</span>
<span class="n">rb</span><span class="o">.</span><span class="n">begin</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</details><p>We hope this tutorial gave enough detail as to the basics of rubato to let you make your own games and simulations!
If you have questions or feedback, please feel free to contact us on our <a class="reference external" href="https://discord.gg/rdce5GXRrC">Discord server</a> or by <a class="reference external" href="mailto:info&#37;&#52;&#48;rubato&#46;app">sending us an email</a>!</p>
</section>
</section>
 
        </article>
      </div>
      <footer>
        
<div class="related-pages">
    <a class="next-page" href="../../advanced/custom_components/">
        <div class="page-info">
            <div class="context">
                <span>Next</span>
            </div>
            <div class="title">Custom Components</div>
        </div>
        <svg><use href="#svg-arrow-right"></use></svg>
    </a> <a class="prev-page" href="../step4/">
        <svg><use href="#svg-arrow-right"></use></svg>
        <div class="page-info">
            <div class="context">
                <span>Previous</span>
            </div>
            
            <div class="title">Step 4 - Creating a Level</div>
            
        </div>
    </a>
</div>
<div class="bottom-of-page">
    <div class="left-details">
        <div class="copyright"> Copyright &#169; 2022, Martin Chaperot, Tomer Sedan, Yamm Elnekave
        </div>
    </div>
    <div class="right-details">
        <div class="icons"><a class="muted-link" href="https://github.com/rubatopy/rubato" aria-label="On GitHub">
                <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 16 16">
                    <path
                        fill-rule="evenodd"
                        d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0 0 16 8c0-4.42-3.58-8-8-8z"
                    ></path>
                </svg>
            </a>
        </div>
    </div>
</div>

      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            Contents
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Step 5 - Finishing Touches</a><ul>
<li><a class="reference internal" href="#jump-limit">Jump Limit</a></li>
<li><a class="reference internal" href="#camera-scroll">Camera Scroll</a></li>
<li><a class="reference internal" href="#to-conclude">To Conclude</a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
    <script src="../../../_static/jquery.js"></script>
    <script src="../../../_static/underscore.js"></script>
    <script src="../../../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../../../_static/doctools.js"></script>
    <script src="../../../_static/scripts/furo.js"></script>
    <script src="../../../_static/clipboard.min.js"></script>
    <script src="../../../_static/copybutton.js"></script>
    <script src="../../../_static/tabs.js"></script>
    <script src="../../../_static/design-tabs.js"></script>
    </body>
</html>